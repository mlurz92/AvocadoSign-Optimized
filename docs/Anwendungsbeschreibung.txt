# Anwendungsbeschreibung: Avocado Sign Analyse Tool v2.5

## 1. Einleitung

### 1.1. Zweck der Anwendung

Das **Avocado Sign Analyse Tool** ist eine spezialisierte Webanwendung für die medizinisch-wissenschaftliche Forschung im Bereich der radiologischen Diagnostik des Rektumkarzinoms. Ihr primäres Ziel ist die detaillierte Analyse und der Performance-Vergleich verschiedener MRT-basierter Kriterien zur Beurteilung des Lymphknotenstatus.

Die Anwendung ermöglicht es Forschern, die diagnostische Güte des neuartigen **"Avocado Signs"** systematisch mit etablierten sowie benutzerdefinierten T2-gewichteten morphologischen Kriterien zu vergleichen. Sie dient als interaktives Werkzeug zur Datenauswertung, zur Hypothesenüberprüfung durch Brute-Force-Optimierung und zur Erstellung von publikationsreifen Manuskriptentwürfen, Tabellen und Abbildungen.

### 1.2. Zielgruppe

Die Anwendung richtet sich an Radiologen, medizinische Forscher, Datenanalysten und Kliniker, die sich mit der onkologischen Bildgebung und der statistischen Auswertung diagnostischer Tests befassen.

---

## 2. Globale Konzepte und Bedienung

### 2.1. Das Kollektiv-Konzept

Das zentrale Steuerungselement der gesamten Anwendung ist die Auswahl des **Patientenkollektivs**. Alle angezeigten Daten, Auswertungen und Statistiken beziehen sich immer auf das aktuell ausgewählte Kollektiv.

* **Globale Auswahl:** Die Auswahl erfolgt über eine Button-Gruppe im Anwendungs-Header.
* **Verfügbare Kollektive:**
    * **Gesamt:** Beinhaltet alle Patienten des Datensatzes.
    * **pRCT:** Limitiert auf die Kohorte, die eine primäre Rektumresektion erhalten hat.
    * **nRCT:** Limitiert auf die Kohorte, die eine neoadjuvante Radiochemotherapie erhalten hat.
* **Auswirkungen:** Eine Änderung des Kollektivs löst eine sofortige Neuberechnung und Aktualisierung aller Inhalte in allen Tabs der Anwendung aus.

### 2.2. Globale Benutzeroberfläche

Die Anwendung ist in drei Hauptbereiche gegliedert:

1.  **Header:** Zeigt den Titel der Anwendung und die globale **Kollektiv-Auswahl**. Darunter befindet sich eine **Statusleiste**, die auf einen Blick die wichtigsten Kennzahlen des aktuell gewählten Kollektivs zusammenfasst (Anzahl Patienten, Verteilung der N-, AS- und T2-Staten).
2.  **Tab-Navigation:** Die Hauptnavigation ermöglicht den Wechsel zwischen den sechs Kernmodulen der Anwendung.
3.  **Inhaltsbereich:** Zeigt den Inhalt des jeweils aktiven Tabs an. Dieser Bereich wird dynamisch aktualisiert.

---

## 3. Detaillierte Beschreibung der Tabs (Kernfunktionen)

Jeder Tab repräsentiert ein spezialisiertes Modul mit einem klaren Funktionsfokus.

### 3.1. Daten-Tab

* **Zweck:** Dient der Anzeige und Sortierung der rohen Patientendaten des ausgewählten Kollektivs in einer übersichtlichen Tabelle.
* **UI-Elemente & Funktionen:**
    * **Patiententabelle:** Eine scroll- und sortierbare Tabelle mit den demographischen und grundlegenden klinischen Daten jedes Patienten.
        * **Sortierung:** Ein Klick auf einen Spaltenkopf sortiert die Tabelle auf- oder absteigend nach dem entsprechenden Merkmal. Ein Pfeil-Icon zeigt die aktive Sortierung an. Die Spalte "N | AS | T2" erlaubt eine Sub-Sortierung nach dem jeweiligen Status.
    * **Aufklappbare Detailansicht:**
        * **Interaktion:** Ein Klick auf eine Patienten-Zeile (erkennbar am Pfeil-Icon <i class="fas fa-chevron-down"></i> am Zeilenanfang) klappt eine Detailansicht auf.
        * **Inhalt:** Diese Ansicht zeigt eine detaillierte Auflistung aller für diesen Patienten dokumentierten Lymphknoten mit ihren spezifischen T2-morphologischen Eigenschaften (Größe, Form, Kontur, etc.).
    * **Button "Alle Details Anzeigen/Ausblenden":** Ein globaler Button oberhalb der Tabelle, der es ermöglicht, die Detailansichten für alle Patienten in der Tabelle gleichzeitig zu öffnen oder zu schließen.

### 3.2. Auswertung-Tab

* **Zweck:** Dies ist die interaktive Werkbank der Anwendung. Hier werden die T2-Kriterien definiert, ihre Auswirkungen live analysiert und eine Brute-Force-Optimierung durchgeführt.
* **UI-Elemente & Funktionen:**
    * **Dashboard:** Bietet eine schnelle visuelle Übersicht über die demographische Verteilung (Alter, Geschlecht, Therapie, Status) des aktuellen Kollektivs in Form von Tortendiagrammen.
    * **T2-Kriterien Definition:** Das Kernstück dieses Tabs.
        * **Kriterien-Schalter:** Für jedes der fünf T2-Merkmale (Größe, Form, Kontur, Homogenität, Signal) kann per Schalter festgelegt werden, ob es in die Auswertung einbezogen werden soll.
        * **Werte-Auswahl:** Für aktive Kriterien können die spezifischen Werte festgelegt werden (z.B. Größe ≥ 5mm; Form = 'rund'). Die Auswahl erfolgt über einen Schieberegler und ein manuelles Eingabefeld für die Größe bzw. über Klick-Buttons für die morphologischen Eigenschaften.
        * **Logik-Schalter (UND/ODER):** Legt fest, ob ein Lymphknoten **alle** (UND) oder **mindestens eines** (ODER) der aktiven Kriterien erfüllen muss, um als T2-positiv zu gelten.
        * **Anwenden & Speichern:** Änderungen an den Kriterien sind zunächst temporär. Erst ein Klick auf diesen Button wendet die neuen Kriterien auf den gesamten Datensatz an, berechnet alle abhängigen Werte (T2-Status, Statistiken etc.) neu und speichert die Einstellung im Browser.
        * **Zurücksetzen:** Verwirft alle ungespeicherten Änderungen und stellt den zuletzt gespeicherten Zustand der Kriterien wieder her.
        * **Indikator "Ungespeicherte Änderungen":** Ein gelbes Badge erscheint, sobald Änderungen vorgenommen, aber noch nicht angewendet wurden.
    * **T2 Metrik-Übersicht:** Eine kompakte Leiste, die live die wichtigsten diagnostischen Gütekriterien (Sensitivität, Spezifität, PPV, NPV, etc.) für die **aktuell angewendeten** T2-Kriterien anzeigt.
    * **Brute-Force Optimierung:**
        * **Zweck:** Ein leistungsstarkes Werkzeug, das automatisch tausende von Kriterien-Kombinationen testet, um diejenige Kombination zu finden, die eine vom Nutzer gewählte **Zielmetrik** (z.B. Balanced Accuracy, F1-Score) maximiert.
        * **Bedienung:** Der Nutzer wählt eine Zielmetrik aus dem Dropdown-Menü und startet den Prozess mit dem **"Optimierung starten"**-Button.
        * **Feedback:** Der Fortschritt wird über einen Ladebalken visualisiert. Nach Abschluss wird das beste gefundene Kriterienset zusammen mit dem erreichten Metrik-Wert angezeigt. Dieses Set kann dann per Klick direkt auf die Anwendung übertragen werden.
    * **Patienten-Auswertungstabelle:** Ähnlich der Tabelle im "Daten"-Tab, zeigt sie jedoch zusätzlich an, wie viele Lymphknoten pro Patient nach den jeweiligen Kriterien (N, AS, T2) als positiv bewertet wurden. Die aufklappbare Detailansicht visualisiert hier, welche spezifischen T2-Merkmale eines Lymphknotens zur positiven oder negativen Gesamtbewertung beigetragen haben.

### 3.3. Statistik-Tab

* **Zweck:** Dient der detaillierten statistischen Auswertung und Gegenüberstellung der diagnostischen Verfahren.
* **UI-Elemente & Funktionen:**
    * **Layout-Umschalter (Einzelansicht/Vergleich):** Ermöglicht den Wechsel zwischen zwei Ansichten:
        * **Einzelansicht:** Zeigt eine umfassende statistische Analyse für das global ausgewählte Kollektiv.
        * **Vergleichsansicht:** Zeigt zwei Einzelansichten nebeneinander an. Über zwei Dropdown-Menüs können die zu vergleichenden Kollektive unabhängig voneinander ausgewählt werden.
    * **Statistik-Karten:** Die Ergebnisse werden in thematisch gruppierten Karten dargestellt:
        * **Deskriptive Statistik:** Grundlegende demographische Daten.
        * **Performance Avocado Sign / T2:** Detaillierte Tabellen mit allen relevanten Gütekriterien (Sensitivität, Spezifität, PPV, NPV, Accuracy, Balanced Accuracy, F1-Score, AUC) inklusive 95%-Konfidenzintervallen.
        * **Vergleich: AS vs. T2:** Ergebnisse der statistischen Vergleichstests (McNemar-Test, DeLong-Test) zur Beurteilung signifikanter Unterschiede in der diagnostischen Leistung.
        * **Assoziation:** Zeigt die statistische Assoziation zwischen den einzelnen T2-Merkmalen und dem histopathologischen N-Status (p-Werte aus Fisher-Exact- oder Mann-Whitney-U-Tests).
        * **Performance-Vergleichs-Chart:** Ein "Dot Plot"-Diagramm, das die AUC-Werte von AS und T2 inklusive ihrer Konfidenzintervalle visuell gegenüberstellt.
    * **Interaktive Tooltips:** Jede einzelne statistische Kennzahl in den Tabellen ist mit einem Tooltip versehen, der bei Mouse-Over eine detaillierte Beschreibung der Metrik sowie eine laienverständliche Interpretation des spezifischen Wertes im Kontext der Daten anzeigt.

### 3.4. Präsentation-Tab

* **Zweck:** Erstellt reduzierte, auf das Wesentliche fokussierte Ansichten, die sich ideal für Präsentationen oder eine schnelle Übersicht eignen.
* **UI-Elemente & Funktionen:**
    * **Ansicht-Umschalter:** Radio-Buttons zum Wechseln zwischen zwei Modi:
        * **AS Pur:** Fokussiert ausschließlich auf das Avocado Sign. Zeigt eine Demographie-Tabelle für das Gesamtkollektiv und eine Performance-Tabelle für das Avocado Sign.
        * **AS vs. T2:** Vergleicht die Performance des Avocado Signs direkt mit einem vom Nutzer auswählbaren, publizierten T2-Kriterien-Set.
    * **Vergleichsstudie-Dropdown:** Wird in der "AS vs. T2"-Ansicht aktiv und erlaubt die Auswahl des T2-Kriteriensets, das als Vergleichsmaßstab dienen soll (z.B. Beets-Tan et al., Koh et al.).
    * **Inhaltskarten:** Je nach gewählter Ansicht werden Karten mit Demographie-, Performance- und Vergleichstabellen sowie einem zentralen Performance-Vergleichs-Chart angezeigt. Alle Elemente sind mit Download-Buttons für verschiedene Formate (CSV, MD, PNG, SVG) ausgestattet.

### 3.5. Publikation-Tab

* **Zweck:** Das Kernstück der Anwendung zur Erstellung eines wissenschaftlichen Manuskripts. Es generiert einen nahezu vollständigen, formatierten und mit den aktuellen Daten befüllten Publikationsentwurf, der den Richtlinien des Journals *Radiology* folgt.
* **UI-Elemente & Funktionen:**
    * **Globale Steuerung:**
        * **Sprach-Umschalter:** Ermöglicht den Wechsel der Manuskriptsprache zwischen Deutsch und Englisch.
        * **Brute-Force Metrik-Auswahl:** Erlaubt die Auswahl der Metrik, die im Ergebnisteil für die Darstellung der Brute-Force-Optimierung verwendet werden soll.
    * **Sektions-Navigation:** Eine seitliche Navigationsleiste ermöglicht den direkten Sprung zu den einzelnen Abschnitten des Manuskripts (Abstract, Einleitung, Methoden, Ergebnisse, Diskussion, Tabellen, Abbildungen, Referenzen).
    * **Inhaltsbereich:**
        * Zeigt den Text des ausgewählten Abschnitts an. Der Text ist dynamisch und wird live aus den aktuellen Daten und Einstellungen generiert (z.B. werden statistische Werte wie p-Werte und Konfidenzintervalle direkt in den Fließtext eingefügt).
        * Ein **Wortzähler** zeigt die aktuelle Wortzahl im Verhältnis zum vom Journal vorgegebenen Limit für die jeweilige Sektion an.
        * Ein **Download-Button** ermöglicht den Export der aktuellen Sektion als Markdown-Datei.

### 3.6. Export-Tab

* **Zweck:** Eine zentrale Anlaufstelle, um alle in der Anwendung generierten Daten, Tabellen, Statistiken und Diagramme in verschiedenen Formaten herunterzuladen.
* **UI-Elemente & Funktionen:**
    * **Export-Karten:** Die Exportoptionen sind in logische Gruppen unterteilt:
        * **Einzel-Exporte:** Download spezifischer Daten, z.B. die Statistik-Übersicht als CSV oder die Brute-Force-Ergebnisse als TXT.
        * **Paket-Exporte (.zip):** Bündeln thematisch zusammengehörige Dateien (z.B. alle Diagramme als PNGs, alle Tabellen als CSVs) in einem einzigen ZIP-Archiv für einfache Archivierung oder Weitergabe.
        * **Excel-Exporte:** Generiert eine einzelne, umfassende Excel-Datei mit mehreren Arbeitsblättern für Daten, Auswertungen und Statistiken.
    * **Button-Zustände:** Buttons für Exporte, die von bestimmten Berechnungen abhängen (z.B. Brute-Force-Ergebnisse), sind nur aktiv, wenn die entsprechenden Daten verfügbar sind.

---

## 4. Daten- und Zustandsmanagement

### 4.1. Persistenz

Die Anwendung speichert automatisch wichtige Benutzereinstellungen im `localStorage` des Webbrowsers. Dazu gehören:
* Das zuletzt ausgewählte globale Kollektiv.
* Die zuletzt angewendeten T2-Kriterien und die zugehörige Logik.
* Die Layout-Einstellungen der verschiedenen Tabs.

Diese Einstellungen bleiben auch nach einem Neuladen der Seite erhalten, was ein nahtloses Weiterarbeiten ermöglicht.

---

## 5. Systemvoraussetzungen

Das **Avocado Sign Analyse Tool** ist eine reine Webanwendung und erfordert keine Installation. Sie wird in einem modernen, aktuellen Webbrowser (z.B. Google Chrome, Mozilla Firefox, Microsoft Edge) ausgeführt. Für eine optimale Performance, insbesondere bei der Brute-Force-Optimierung, wird ein System mit einer aktuellen CPU empfohlen.
