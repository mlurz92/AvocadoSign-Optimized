# Anwendungsbeschreibung: AvocadoSign Analyse Tool v2.5.0

## 1. Einleitung

Das **AvocadoSign Analyse Tool v2.5.0** ist eine spezialisierte Webanwendung, die f√ºr die medizinisch-wissenschaftliche Forschung im Bereich der rektalen Karzinomdiagnostik entwickelt wurde. Ihr prim√§rer Zweck ist die detaillierte Analyse und der Vergleich der diagnostischen G√ºte des "Avocado Signs" (AS) ‚Äì eines neuartigen MRT-basierten Bildgebungsmarkers ‚Äì mit etablierten morphologischen T2-gewichteten MRT-Kriterien (T2-Kriterien) zur Vorhersage des Lymphknotenstatus (N-Status) bei Patienten mit Rektumkarzinom.

Die Anwendung richtet sich an Radiologen, Onkologen, medizinische Forscher und Datenanalysten, die an der Validierung und explorativen Untersuchung diagnostischer Marker beteiligt sind. Sie erm√∂glicht es Nutzern, Patientendaten zu verwalten, T2-Kriterien interaktiv zu definieren und anzuwenden, datengetriebene Optimierungen dieser Kriterien durchzuf√ºhren (Brute-Force-Optimierung) und umfassende statistische Auswertungen sowie Vergleiche zu generieren. Ein besonderer Fokus liegt auf der Unterst√ºtzung bei der Erstellung wissenschaftlicher Publikationen durch die automatische Generierung von Textentw√ºrfen f√ºr Methoden- und Ergebnisabschnitte sowie publikationsreifen Tabellen und Diagrammen.

**Hauptfunktionen im √úberblick:**

* **Datenvisualisierung und -management:** Anzeige und Filterung von Patientendaten und Lymphknotenmerkmalen.
* **Interaktive T2-Kriterien-Definition:** Flexible Definition von T2-basierten Malignit√§tskriterien f√ºr Lymphknoten.
* **Brute-Force-Optimierung:** Automatische Suche nach der optimalen T2-Kriterienkombination zur Maximierung einer gew√§hlten diagnostischen Metrik.
* **Umfassende statistische Analyse:** Berechnung diverser G√ºtekriterien (Sensitivit√§t, Spezifit√§t, PPV, NPV, Accuracy, Balanced Accuracy/AUC) inklusive Konfidenzintervallen, statistische Vergleiche zwischen diagnostischen Methoden (AS vs. T2) und Assoziationsanalysen.
* **Vergleich mit Literatur-Kriterien:** Implementierung und vergleichende Analyse etablierter T2-Kriteriensets aus der Fachliteratur.
* **Publikationsunterst√ºtzung:** Generierung von Textentw√ºrfen (Methoden, Ergebnisse) und Materialien f√ºr wissenschaftliche Manuskripte, insbesondere f√ºr Einreichungen bei Fachjournalen wie "Radiology".
* **Datenexport:** Umfangreiche Exportoptionen f√ºr Rohdaten, Analyseergebnisse, Tabellen und Diagramme in verschiedenen Formaten.

Diese Anwendungsbeschreibung erl√§utert detailliert alle Funktionen und Bedienkonzepte des AvocadoSign Analyse Tools v2.5.0.

## 2. Systemanforderungen und Einrichtung

Das AvocadoSign Analyse Tool ist eine reine Webanwendung und erfordert keine lokale Installation.

* **Browser-Kompatibilit√§t:** Die Anwendung ist f√ºr moderne Webbrowser wie Google Chrome (empfohlen), Mozilla Firefox, Microsoft Edge und Safari optimiert. Es wird empfohlen, stets die aktuellste Version des Browsers zu verwenden.
* **JavaScript:** JavaScript muss im Browser aktiviert sein.
* **Externe Bibliotheken:** Die Anwendung nutzt verschiedene JavaScript-Bibliotheken (z.B. D3.js f√ºr Diagramme, Bootstrap f√ºr das UI-Framework, Tippy.js f√ºr Tooltips, JSZip und FileSaver.js f√ºr Exporte, SheetJS f√ºr Excel-Exporte, html2canvas f√ºr Bildexporte von Tabellen), die √ºber Content Delivery Networks (CDNs) dynamisch geladen werden. Eine aktive Internetverbindung ist daher f√ºr die vollst√§ndige Funktionalit√§t beim ersten Laden und f√ºr das Laden dieser Bibliotheken erforderlich.
* **Bildschirmaufl√∂sung:** F√ºr eine optimale Darstellung und Bedienbarkeit wird eine Bildschirmaufl√∂sung von mindestens 1280x768 Pixeln empfohlen.

## 3. Globale UI-Konzepte und Bedienung

Die Benutzeroberfl√§che des AvocadoSign Analyse Tools ist darauf ausgelegt, eine intuitive und effiziente Interaktion mit den komplexen Daten und Analysefunktionen zu erm√∂glichen.

### 3.1. Hauptlayout

Das Hauptlayout der Anwendung gliedert sich in drei Bereiche:

1.  **Header-Bereich (Kopfzeile):** Befindet sich am oberen Bildschirmrand und ist stets sichtbar.
2.  **Navigationsleiste (Tabs):** Direkt unterhalb des Headers, ebenfalls fixiert (sticky).
3.  **Inhaltsbereich:** Der Hauptbereich unterhalb der Navigationsleiste, in dem die Inhalte des jeweils aktiven Tabs angezeigt werden.

### 3.2. Header-Bereich

Der Header enth√§lt folgende Elemente (von links nach rechts):

* **App-Titel und Version:** Zeigt das Logo (ü•ë), den Namen "AvocadoSign Analyse" und die aktuelle Versionsnummer der Anwendung (z.B. "v2.5.0").
* **Kollektiv-Auswahl:** Eine Gruppe von drei Buttons ("Gesamt", "Direkt OP", "nRCT"), mit denen der Nutzer das globale Patientenkollektiv f√ºr alle Analysen ausw√§hlen kann.
    * **Funktion:** Filtert die zugrundeliegenden Patientendaten.
    * **Interaktion:** Klick auf einen Button w√§hlt das entsprechende Kollektiv aus. Der aktive Button ist hervorgehoben.
    * **Auswirkung:** Alle Tabellen, Statistiken und Diagramme in der gesamten Anwendung werden basierend auf dem hier gew√§hlten Kollektiv aktualisiert.
* **Statusanzeigen (Header Stats):** Eine Reihe von Badges, die dynamisch aktualisierte Schl√ºsselinformationen zum aktuell ausgew√§hlten Kollektiv anzeigen:
    * **Kollektiv:** Name des aktiven Kollektivs.
    * **N=:** Gesamtzahl der Patienten im aktiven Kollektiv.
    * **Patho-N:** Verteilung des pathologischen N-Status (+/-) im Kollektiv.
    * **AS:** Verteilung des Avocado Sign Status (+/-) im Kollektiv.
    * **T2:** Verteilung des T2-Kriterien Status (+/-) im Kollektiv (basierend auf den aktuell *angewendeten* T2-Kriterien).
* **Kurzanleitung-Button:** Ein Info-Icon (<i class="fas fa-info-circle"></i>).
    * **Funktion:** √ñffnet ein modales Fenster mit einer Kurzanleitung zur Bedienung der Anwendung und wichtigen Hinweisen.
    * **Interaktion:** Klick auf den Button.

### 3.3. Navigationsleiste (Tabs)

Unterhalb des Headers befindet sich eine Navigationsleiste mit den folgenden Tabs, die den Zugriff auf die Kernfunktionen der Anwendung erm√∂glichen:

* **Daten:** Anzeige der detaillierten Patienten- und Lymphknotendaten.
* **Auswertung:** Definition von T2-Kriterien, Dashboard mit deskriptiven Kacheln und Diagrammen, Brute-Force-Optimierung und detaillierte Auswertungstabelle.
* **Statistik:** Umfassende statistische Analysen und Vergleiche.
* **Pr√§sentation:** Aufbereitete Ergebnisse und Diagramme f√ºr Vortragszwecke.
* **Publikation:** Generierung von Textentw√ºrfen, Tabellen und Diagrammen zur Unterst√ºtzung bei der Erstellung wissenschaftlicher Manuskripte.
* **Export:** Download-Optionen f√ºr Daten, Ergebnisse, Tabellen und Diagramme.

**Interaktion:** Ein Klick auf einen Tab-Button macht diesen aktiv und l√§dt den entsprechenden Inhalt in den Hauptinhaltsbereich. Der aktive Tab ist visuell hervorgehoben.

### 3.4. Allgemeine Bedienelemente

* **Tooltips:** Viele UI-Elemente (Buttons, Eingabefelder, Spalten√ºberschriften, Metrikwerte etc.) verf√ºgen √ºber Tooltips, die bei Mouseover detaillierte Erkl√§rungen oder Zusatzinformationen anzeigen. Diese werden durch die Bibliothek Tippy.js realisiert und haben ein einheitliches "Glassmorphism"-Design.
* **Toast-Benachrichtigungen:** Die Anwendung verwendet kurze Einblendungen (Toasts) am unteren rechten Bildschirmrand, um den Nutzer √ºber erfolgreiche Aktionen (z.B. "Daten gespeichert"), Warnungen oder Fehler zu informieren.
* **Modale Fenster:** F√ºr bestimmte Funktionen wie die Anzeige der Top-Brute-Force-Ergebnisse oder die Kurzanleitung werden modale Fenster (Dialoge) verwendet, die sich √ºber den Hauptinhalt legen.

## 4. Datenmanagement und -grundlage

Die Anwendung verarbeitet einen vordefinierten Datensatz von Patienten mit Rektumkarzinom. Dieser Datensatz ist fest in die Anwendung integriert (`data/data.js`) und kann nicht vom Nutzer modifiziert oder hochgeladen werden.

* **Patientendaten:** Umfassen anonymisierte/kodierte Identifikationsnummern, demographische Daten (Alter, Geschlecht), Therapieinformation (Direkt OP oder nRCT), den pathologischen N-Status (Referenzstandard) und den AS-Status.
* **Lymphknotendaten:** F√ºr jeden Patienten k√∂nnen detaillierte Informationen zu einzelnen Lymphknoten gespeichert sein, die im T2-gewichteten MRT beurteilt wurden. Diese umfassen typischerweise:
    * Gr√∂√üe (Kurzachsendurchmesser in mm)
    * Form (z.B. rund, oval)
    * Kontur (z.B. scharf, irregul√§r)
    * Homogenit√§t (z.B. homogen, heterogen)
    * Signalintensit√§t (z.B. signalarm, intermedi√§r, signalreich)
    Diese Merkmale bilden die Basis f√ºr die T2-Kriterien-Definition und -Anwendung.

Die Patientendaten und die abgeleiteten Status (N, AS, T2) werden in verschiedenen Tabellen und f√ºr statistische Berechnungen verwendet.

## 5. Kernfunktionen und Module (Beschreibung der Tabs)

### 5.1. Daten-Tab

Der "Daten"-Tab dient der Anzeige der zugrundeliegenden Patientendaten des aktuell im Header ausgew√§hlten Kollektivs.

* **Patiententabelle:**
    * **Anzeige:** Zeigt eine tabellarische √úbersicht der Patienten mit Spalten f√ºr Nr., Name (kodiert), Vorname (kodiert), Geschlecht, Alter, Therapie, den aggregierten Status (N/AS/T2) und ggf. Bemerkungen.
    * **Sortierung:** Die Tabelle kann durch Klick auf die Spalten√ºberschriften nach der jeweiligen Spalte sortiert werden (aufsteigend/absteigend). Die Status-Spalte "N/AS/T2" erlaubt eine Sub-Sortierung nach N, AS oder T2 durch Klick auf die entsprechenden Buchstaben im Spaltenkopf. Die aktive Sortierung wird durch Pfeil-Icons und Hervorhebung angezeigt.
    * **Detailansicht Lymphknoten:** Jede Patientenreihe kann aufgeklappt werden (Klick auf die Reihe oder den Pfeil-Button am Zeilenanfang), um eine detaillierte Tabelle der T2-bewerteten Lymphknoten dieses Patienten anzuzeigen. Diese Tabelle listet f√ºr jeden Lymphknoten die morphologischen Merkmale (Gr√∂√üe, Form, Kontur, Homogenit√§t, Signal) auf.
    * **"Alle Details Anzeigen/Ausblenden"-Button:** Am unteren Rand der Tabelle befindet sich ein Button, um alle Detailansichten gleichzeitig zu √∂ffnen oder zu schlie√üen.

### 5.2. Auswertung-Tab

Dieser Tab ist zentral f√ºr die Definition von T2-Kriterien, die Brute-Force-Optimierung und die Anzeige der daraus resultierenden Patientenauswertung.

#### 5.2.1. Dashboard

Am oberen Rand des Auswertung-Tabs befindet sich ein Dashboard mit Kacheln, die eine deskriptive √úbersicht √ºber das aktuell ausgew√§hlte Kollektiv geben:
* Altersverteilung (Histogramm)
* Geschlechterverteilung (Tortendiagramm)
* Therapieverteilung (Tortendiagramm)
* Verteilung des N-Status (Tortendiagramm)
* Verteilung des AS-Status (Tortendiagramm)
* Verteilung des T2-Status (basierend auf aktuell angewandten Kriterien, Tortendiagramm)
Jede Kachel und jedes Diagramm verf√ºgt √ºber Tooltips mit Detailinformationen. Die Diagramme k√∂nnen als PNG oder SVG heruntergeladen werden (Buttons in der Kachel-Kopfzeile).

#### 5.2.2. T2-Kriterien-Definition

Eine interaktive Karte erm√∂glicht die Definition der T2-basierten Malignit√§tskriterien f√ºr Lymphknoten:

* **Logik-Umschalter:** Ein Switch-Button ("UND"/"ODER") bestimmt, wie die aktivierten Einzelkriterien verkn√ºpft werden.
    * **UND:** Ein Lymphknoten gilt nur als T2-positiv, wenn *alle* aktivierten Kriterien erf√ºllt sind.
    * **ODER:** Ein Lymphknoten gilt als T2-positiv, wenn *mindestens ein* aktiviertes Kriterium erf√ºllt ist.
* **Einzelkriterien:** F√ºr jedes der f√ºnf morphologischen Merkmale (Gr√∂√üe, Form, Kontur, Homogenit√§t, Signal) gibt es eine Kontrollgruppe:
    * **Checkbox:** Aktiviert oder deaktiviert das jeweilige Kriterium. Nur aktive Kriterien flie√üen in die Bewertung ein.
    * **Spezifische Einstellungen:**
        * **Gr√∂√üe:** Ein Schieberegler und ein numerisches Eingabefeld erlauben die Einstellung des Schwellenwerts f√ºr den Kurzachsendurchmesser (in mm). Lymphknoten mit einem Durchmesser gr√∂√üer oder gleich (‚â•) diesem Wert erf√ºllen das Kriterium.
        * **Form, Kontur, Homogenit√§t, Signal:** F√ºr diese qualitativen Merkmale k√∂nnen die als suspekt geltenden Auspr√§gungen (z.B. Form "rund", Kontur "irregul√§r") √ºber Buttons ausgew√§hlt werden. Die Buttons zeigen kleine Icons zur Visualisierung der Merkmalsauspr√§gung.
* **Statusanzeige (`#t2-criteria-status-text`):** Ein Text im Header der Karte zeigt an, ob die aktuell im Formular sichtbaren Kriterien und die Logik den global *angewendeten und gespeicherten* Kriterien entsprechen ("Status: Angewandte Kriterien geladen.") oder ob ungespeicherte √Ñnderungen vorliegen ("Status: Ungespeicherte √Ñnderungen vorhanden.").
* **Visueller Indikator f√ºr ungespeicherte √Ñnderungen:** Wenn √Ñnderungen an Kriterien oder Logik vorgenommen, aber noch nicht angewendet wurden, erh√§lt die Kriterien-Karte einen gestrichelten Warnrahmen und einen Tooltip, der auf die ungespeicherten √Ñnderungen hinweist.
* **Aktionsbuttons:**
    * **"Zur√ºcksetzen (Standard)":** Setzt alle Kriterien und die Logik auf vordefinierte Standardwerte zur√ºck. Die √Ñnderungen sind danach noch nicht angewendet.
    * **"Anwenden & Speichern":** √úbernimmt die aktuell im Formular eingestellten Kriterien und die Logik. Diese werden global in der Anwendung wirksam (beeinflusst T2-Status in allen Tabs, Statistiken, Diagrammen) und im Local Storage des Browsers f√ºr zuk√ºnftige Sitzungen gespeichert. Der Statusindikator und der Warnrahmen werden entsprechend aktualisiert.

#### 5.2.3. Brute-Force-Optimierung

Diese Funktion erm√∂glicht die datengetriebene Optimierung der T2-Kriterien:

* **Zielmetrik-Auswahl:** Ein Dropdown-Men√º erlaubt die Auswahl der diagnostischen Metrik (z.B. Balanced Accuracy, Accuracy, F1-Score, PPV, NPV), die durch die Optimierung maximiert werden soll.
* **"Optimierung starten"-Button:** Startet den Brute-Force-Suchalgorithmus. Dieser testet systematisch eine Vielzahl von Kombinationen der f√ºnf T2-Merkmale und der beiden Logiken (UND/ODER), um diejenige Kombination zu finden, die die gew√§hlte Zielmetrik f√ºr das aktuell im Header ausgew√§hlte Kollektiv maximiert.
    * **Hinweis:** Die Optimierung l√§uft als Hintergrundprozess (Web Worker) und kann je nach Datenmenge und Komplexit√§t einige Zeit in Anspruch nehmen. Der Rest der Anwendung bleibt w√§hrenddessen bedienbar.
* **Status- und Fortschrittsanzeige:**
    * Zeigt den aktuellen Status des Optimierungsprozesses (z.B. "Bereit", "Initialisiere...", "Teste...", "Fertig", "Fehler", "Abgebrochen").
    * Ein Fortschrittsbalken visualisiert den Abarbeitungsgrad der Kombinationen.
    * Zeigt die Anzahl getesteter vs. gesamter Kombinationen.
    * Zeigt den bisher besten gefundenen Wert f√ºr die Zielmetrik und die zugeh√∂rige Kriterienkombination in Echtzeit an.
* **"Abbrechen"-Button:** Erscheint w√§hrend einer laufenden Optimierung und erm√∂glicht deren vorzeitigen Abbruch.
* **Ergebnisanzeige (nach Abschluss):**
    * Zeigt den besten Wert der Zielmetrik, die zugeh√∂rige Logik und die Kriterienkombination.
    * Informiert √ºber die Dauer der Optimierung, die Anzahl getesteter Kombinationen und die Gr√∂√üe des verwendeten Kollektivs (N gesamt, N+, N-).
    * **"Anwenden"-Button:** √úbernimmt die beste gefundene Kriterienkombination als aktuell angewandte T2-Kriterien in der gesamten Anwendung (analog zum "Anwenden & Speichern"-Button im Definitionsbereich).
    * **"Details & Top Ergebnisse"-Button:** √ñffnet ein modales Fenster.
        * **Modalinhalt:** Zeigt eine tabellarische √úbersicht der Top-Kriterienkombinationen (typischerweise die besten 10 oder mehr bei gleichen Werten), sortiert nach der Zielmetrik. F√ºr jede Kombination werden nun **alle relevanten diagnostischen Metriken** (Zielmetrikwert, Sensitivit√§t, Spezifit√§t, PPV, NPV, Accuracy, Balanced Accuracy) sowie die Logik und die Kriterien angezeigt. Enth√§lt ebenfalls Informationen zur Optimierung (Kollektiv, Dauer etc.).
        * **"Bericht als TXT"-Button im Modal:** Exportiert die im Modal angezeigten Detailergebnisse als formatierte Textdatei.

#### 5.2.4. Auswertungstabelle

Unterhalb der Kriterien-Definition und Brute-Force-Optimierung befindet sich eine Tabelle, die √§hnlich der Tabelle im "Daten"-Tab aufgebaut ist:
* **Anzeige:** Patienten des aktuellen Kollektivs mit Nr., Name, Therapie und Status (N/AS/T2).
* **Zus√§tzliche Spalten:**
    * **N+/N ges.:** Anzahl pathologisch positiver Lymphknoten / Gesamtzahl histopathologisch untersuchter Lymphknoten pro Patient.
    * **AS+/AS ges.:** Anzahl AS-positiver Lymphknoten / Gesamtzahl im T1KM-MRT sichtbarer Lymphknoten pro Patient.
    * **T2+/T2 ges.:** Anzahl T2-positiver Lymphknoten (gem√§√ü aktuell angewandter Kriterien) / Gesamtzahl im T2-MRT sichtbarer Lymphknoten pro Patient.
* **Detailansicht Lymphknotenbewertung:** Jede Patientenreihe kann aufgeklappt werden. Die Detailansicht zeigt hier nicht nur die morphologischen Merkmale der T2-Lymphknoten, sondern auch, welche der aktuell angewandten T2-Kriterien von jedem einzelnen Lymphknoten erf√ºllt wurden. Erf√ºllte Kriterien, die zur Positiv-Klassifizierung eines Lymphknotens beitragen, werden hervorgehoben.
* **Sortierung und "Alle Details"-Button:** Analog zur Tabelle im "Daten"-Tab.

### 5.3. Statistik-Tab

Dieser Tab bietet eine umfassende statistische Auswertung der diagnostischen Methoden.

* **Layout- und Kollektiv-Auswahl (Kopfbereich des Tabs):**
    * **Layout-Schalter ("Einzelansicht Aktiv" / "Vergleich Aktiv"):**
        * **Einzelansicht:** Zeigt detaillierte Statistiken f√ºr das global im Haupt-Header ausgew√§hlte Kollektiv.
        * **Vergleich Aktiv:** Erm√∂glicht die Auswahl von zwei spezifischen Kollektiven (Dropdowns "Kollektiv 1" und "Kollektiv 2") f√ºr einen direkten statistischen Vergleich ihrer Ergebnisse. Die angezeigten Statistikkarten beziehen sich dann auf diese beiden ausgew√§hlten Kollektive.
* **Statistik-Karten:** Der Hauptbereich des Tabs zeigt verschiedene Karten mit spezifischen Analysen. Jede Karte hat einen Titel und oft Download-Buttons f√ºr die dargestellten Tabellen (als PNG) oder Diagramme (als PNG/SVG).
    * **Deskriptive Statistik:**
        * Zeigt eine Tabelle mit demographischen Daten (Alter Median/Range/Mean¬±SD, Geschlechterverteilung, Therapieverteilung, N/AS/T2-Status Verteilung) und Lymphknotenanzahlen (Median/Range/Mean¬±SD f√ºr N gesamt, N+, AS gesamt, AS+, T2 gesamt, T2+) f√ºr das/die ausgew√§hlte(n) Kollektiv(e).
        * Enth√§lt Diagramme zur Alters- und Geschlechterverteilung.
    * **Diagnostische G√ºte Avocado Sign (AS):**
        * Zeigt eine Konfusionsmatrix (AS vs. N-Status).
        * Listet detailliert die diagnostischen G√ºtekriterien f√ºr AS auf: Sensitivit√§t, Spezifit√§t, PPV, NPV, Accuracy, Balanced Accuracy, F1-Score, AUC (Balanced Accuracy). Alle Werte werden mit 95%-Konfidenzintervallen (CIs) und der **Methode zur CI-Berechnung** (z.B. "Wilson Score", "Bootstrap Percentile") angezeigt.
    * **Diagnostische G√ºte T2-Kriterien (angewandt):**
        * Analoge Darstellung zur "Diagnostische G√ºte AS"-Karte, jedoch f√ºr die aktuell im "Auswertung"-Tab definierten und angewendeten T2-Kriterien.
    * **Statistischer Vergleich AS vs. T2 (angewandt):**
        * Zeigt die Ergebnisse gepaarter statistischer Tests zum Vergleich der Performance von AS und den angewandten T2-Kriterien f√ºr das/die ausgew√§hlte(n) Kollektiv(e).
        * Enth√§lt p-Werte f√ºr den McNemar-Test (Vergleich der Accuracy basierend auf diskordanten Paaren) und den DeLong-Test (Vergleich der AUC-Werte).
    * **Assoziationen Einzelmerkmale vs. N-Status:**
        * Analysiert den Zusammenhang zwischen dem AS-Status bzw. einzelnen T2-Merkmalen (basierend auf der aktuellen Definition im Auswertungstab, z.B. "T2 Gr√∂√üe ‚â• 5.0mm") und dem pathologischen N-Status.
        * Zeigt f√ºr jedes Merkmal die 2x2 Konfusionsmatrix, Odds Ratio (OR) mit 95%-CI, Risk Difference (RD) mit 95%-CI, Phi-Koeffizient (œÜ) und den p-Wert eines geeigneten Tests (z.B. Fisher's Exact Test).
        * Enth√§lt auch einen Mann-Whitney-U-Test zum Vergleich der Lymphknotengr√∂√üen zwischen N+ und N- Patienten.
    * **Vergleich Kollektive (nur bei Layout "Vergleich Aktiv"):**
        * Vergleicht die Accuracy und AUC-Werte f√ºr AS und die angewandten T2-Kriterien zwischen den beiden im Tab-Header ausgew√§hlten Kollektiven mittels ungepaarter Tests (Fisher's Exact f√ºr Accuracy, Z-Test f√ºr AUC). Zeigt p-Werte und ggf. AUC-Differenzen.
    * **Kriterienvergleichstabelle:**
        * Eine √ºbergreifende Tabelle, die die wichtigsten Performance-Metriken (Sens, Spez, PPV, NPV, Acc, AUC/BalAcc) f√ºr das Avocado Sign, die aktuell angewandten T2-Kriterien und die implementierten Literatur-Kriteriensets (Koh et al., Barbaro et al., ESGAR 2016) nebeneinander darstellt.
        * Die Literatur-Sets werden dabei auf ihrem jeweils spezifischen Zielkollektiv evaluiert, falls dieses vom global gew√§hlten Kollektiv abweicht (dies wird in der Tabelle vermerkt). Die Werte f√ºr AS und angewandte T2-Kriterien beziehen sich auf das global gew√§hlte Kollektiv.

### 5.4. Pr√§sentation-Tab

Dieser Tab dient der schnellen Erstellung von √úbersichten und Diagrammen, die f√ºr Pr√§sentationen geeignet sind.

* **Ansichtsauswahl (Radiobuttons):**
    * **"Avocado Sign (Performance)":** Zeigt eine Tabelle mit den Performance-Metriken (Sens, Spez, PPV, NPV, Acc, AUC) des Avocado Signs f√ºr die drei Hauptkollektive (Gesamt, Direkt OP, nRCT).
    * **"AS vs. T2 (Vergleich)":** Erm√∂glicht einen direkten Vergleich des Avocado Signs mit einer ausgew√§hlten T2-Kriterienbasis.
* **T2-Vergleichsbasis Auswahl (Dropdown, nur bei Ansicht "AS vs. T2"):**
    * Erm√∂glicht die Auswahl einer T2-Kriterienbasis f√ºr den Vergleich. Optionen umfassen:
        * Die aktuell im "Auswertung"-Tab eingestellten und angewendeten T2-Kriterien.
        * Vordefinierte T2-Kriteriensets aus der Literatur (Koh et al., Barbaro et al., ESGAR 2016).
    * Bei Auswahl eines Literatur-Sets passt sich das f√ºr den Vergleich verwendete Patientenkollektiv ggf. automatisch an das Zielkollektiv der jeweiligen Studie an (z.B. nur nRCT-Patienten f√ºr Barbaro et al.).
* **Informationskarte zur T2-Basis (nur bei Ansicht "AS vs. T2"):**
    * Zeigt Details zur ausgew√§hlten T2-Vergleichsbasis an: Referenz, urspr√ºngliches Studienkollektiv, Art der Untersuchung und eine Zusammenfassung der Kriterien.
* **Ergebnisanzeige:**
    * Je nach gew√§hlter Ansicht werden eine oder mehrere Tabellen und ein Diagramm angezeigt.
    * **Bei "AS vs. T2 Vergleich":**
        * Eine Tabelle mit den Werten der diagnostischen Metriken (Sens, Spez etc. mit 95%-CI) f√ºr AS und die gew√§hlte T2-Basis, jeweils f√ºr das relevante Vergleichskollektiv.
        * Eine Tabelle mit den Ergebnissen der statistischen Tests (McNemar f√ºr Accuracy, DeLong f√ºr AUC) zum Vergleich von AS vs. T2-Basis.
        * Ein Balkendiagramm, das ausgew√§hlte Metriken (z.B. Sens, Spez, AUC) f√ºr AS und die T2-Basis vergleichend darstellt.
* **Download-Optionen:** F√ºr alle angezeigten Tabellen und das Diagramm gibt es Buttons zum Herunterladen als CSV, Markdown (MD), PNG oder SVG.

### 5.5. Publikation-Tab

Dieser Tab ist ein Kernst√ºck der Anwendung und dient der umfassenden Unterst√ºtzung bei der Erstellung einer wissenschaftlichen Publikation, die das Avocado Sign mit Literatur-basierten und Brute-Force-optimierten T2-Kriterien vergleicht. Der Fokus liegt auf der Generierung von Textentw√ºrfen f√ºr die Methoden- und Ergebnisabschnitte.

* **Bedienelemente im oberen Bereich des Tabs (sticky):**
    * **Sektionsnavigation (links):** Eine vertikale Navigationsleiste zeigt die Hauptsektionen "Methoden" und "Ergebnisse" an. Ein Klick auf eine Sektion l√§dt die zugeh√∂rigen Inhalte in den Hauptbereich.
    * **Sprachauswahl (rechts oben):** Ein Switch-Button ("Deutsch"/"English") erm√∂glicht die Umschaltung der Sprache f√ºr die generierten Texte und die Beschriftungen einiger UI-Elemente im Tab.
    * **Optimierungsmetrik f√ºr T2 (BF) Auswahl (rechts oben):** Ein Dropdown-Men√º erlaubt die Auswahl der Zielmetrik (z.B. Balanced Accuracy, Accuracy), deren Brute-Force-Optimierungsergebnisse im generierten Ergebnisteil und den zugeh√∂rigen Vergleichen verwendet und dargestellt werden sollen. Eine √Ñnderung dieser Auswahl f√ºhrt zur Neuberechnung der relevanten Statistiken und zur Aktualisierung der generierten Texte und Elemente.
* **Inhaltsbereich (rechts):** Zeigt den generierten Markdown-Text f√ºr die ausgew√§hlte Hauptsektion (Methoden oder Ergebnisse) an. Dieser Bereich ist scrollbar.
    * Innerhalb des Textes werden dynamisch statistische Werte, Konfidenzintervalle, p-Werte, N-Zahlen etc. aus den aufbereiteten Daten eingef√ºgt.
    * Referenzen zu Tabellen und Abbildungen (z.B. "Tabelle 1", "Abbildung 2A") werden gem√§√ü den Definitionen in der Publikationskonfiguration eingef√ºgt.
    * Platzhalter f√ºr Tabellen und Diagramme (`<div id="pub-table-xyz"></div>`, `<div id="pub-chart-xyz"></div>`) werden im HTML gerendert, und diese Divs werden dann dynamisch mit den entsprechenden Tabellen oder Diagrammen gef√ºllt.
* **Generierte Inhalte - Methoden:** Die Sektion "Methoden" wird mit detaillierten Textvorschl√§gen f√ºr folgende Unterabschnitte bef√ºllt:
    * **Studiendesign und Ethikfreigabe:** Beschreibung des Studiendesigns, Ethikvotum, Studienzeitraum, Hinweis auf Softwarenutzung.
    * **Patientenkollektiv:** Beschreibung der Gesamtkohorte und Subgruppen, Ein- und Ausschlusskriterien, Verweis auf Tabelle 1.
    * **MRT-Protokoll und Bildakquisition:** Details zum MRT-System, Kontrastmittel, Sequenzen, Schichtdicke, Verweis auf Abbildung 1 (externe Beispielabbildung).
    * **Definition und Bewertung des Avocado Signs (AS):** Pr√§zise Definition, Bewertungsmethode, Verweis auf Originalpublikation und Abbildung 2 (externe Beispielabbildung des AS).
    * **Definition und Bewertung von T2-Kriterien:**
        * Beschreibung der implementierten Literatur-basierten T2-Kriterien (Koh, Barbaro, ESGAR/Ruteg√•rd) mit Referenzen und Verweis auf Tabelle 2.
        * Detaillierte Beschreibung der Methode zur Brute-Force-Optimierung der T2-Kriterien, inklusive der variierten Merkmale und der Zielmetrik.
    * **Referenzstandard:** Histopathologie.
    * **Statistische Analyse:** Auflistung der Metriken, CI-Methoden, Vergleichstests, Signifikanzniveau, Software.
* **Generierte Inhalte - Ergebnisse:** Die Sektion "Ergebnisse" wird mit detaillierten Textvorschl√§gen und den zugeh√∂rigen Tabellen/Diagrammen f√ºr folgende Unterabschnitte bef√ºllt:
    * **Patientencharakteristika:** Zusammenfassung mit Verweis auf Tabelle 1 und Abbildung 3 (Demographie-Charts).
    * **Diagnostische G√ºte des Avocado Signs:** Detaillierte Darstellung der Performance-Metriken f√ºr AS (mit CIs) f√ºr alle Kollektive, Verweis auf Tabelle 3.
    * **Diagnostische G√ºte der Literatur-basierten T2-Kriterien:** Darstellung der Performance f√ºr jedes Literatur-Set, Verweis auf Tabelle 4.
    * **Diagnostische G√ºte der Brute-Force optimierten T2-Kriterien:** Darstellung der Performance des BF-optimierten Sets (basierend auf der ausgew√§hlten Zielmetrik), Nennung der Kriteriendefinition, Verweis auf Tabelle 5.
    * **Statistischer Vergleich der diagnostischen G√ºte:** Direkter Vergleich von AS vs. Literatur-T2 und AS vs. BF-T2 (p-Werte, AUC-Differenzen), Verweis auf Tabelle 6, Konfusionsmatrizen (Tabelle 7) und Vergleichsdiagramme (Abbildung 4, Abbildung 5).
* **Referenzliste:** Am Ende der generierten Methoden- und Ergebnisabschnitte wird eine formatierte Liste der Schl√ºsselreferenzen (aus `APP_CONFIG.REFERENCES_FOR_PUBLICATION`) angeh√§ngt.
* **Hinweis zur Weiterverarbeitung:** Ein Texthinweis informiert den Nutzer, dass die generierten Inhalte als Entwurf dienen und f√ºr die finale Publikation sorgf√§ltig √ºberpr√ºft und angepasst werden m√ºssen.

### 5.6. Export-Tab

Dieser Tab bietet eine zentrale Stelle zum Herunterladen verschiedener Daten und Analyseergebnisse.

* **Hinweis:** Alle Exporte basieren auf dem aktuell im Haupt-Header ausgew√§hlten globalen Kollektiv und den zuletzt im "Auswertung"-Tab *angewendeten und gespeicherten* T2-Kriterien.
* **Exportoptionen (Buttons, gruppiert):**
    * **Einzelexporte:**
        * **Statistik Ergebnisse (.csv):** Detaillierte Tabelle aller berechneten statistischen Metriken aus dem Statistik-Tab.
        * **Brute-Force Bericht (.txt):** Detaillierter Bericht der letzten Brute-Force-Optimierung f√ºr das aktuelle Kollektiv (Top Ergebnisse, Konfiguration). Nur aktiv, wenn ein BF-Lauf durchgef√ºhrt wurde.
        * **Deskriptive Statistik (.md):** Tabelle der deskriptiven Statistik (Statistik-Tab) als Markdown.
        * **Umfassender Bericht (.html):** Ein kombinierter HTML-Bericht mit Statistiken, Konfigurationen und eingebetteten (nicht-interaktiven) Diagrammen.
        * **Datenliste (.md):** Aktuelle Patientenliste (Daten-Tab) als Markdown-Tabelle.
        * **Auswertungstabelle (.md):** Aktuelle Auswertungstabelle (Auswertung-Tab, inkl. T2-Ergebnisse) als Markdown.
        * **Gefilterte Rohdaten (.csv):** Rohdaten des aktuell ausgew√§hlten Kollektivs (inkl. T2-Bewertung gem√§√ü angewandter Kriterien).
        * **Diagramme & Tabellen (PNG) (.zip):** Ein ZIP-Archiv mit allen aktuell im Statistik-, Auswertungs- (Dashboard) und Publikationstab sichtbaren/gerenderten Diagrammen und ausgew√§hlten Tabellen als einzelne PNG-Dateien. Diagramme werden f√ºr diesen Export **in englischer Sprache und im Journal-Stil** (publikationsoptimiert, ggf. Graustufen je nach globaler Einstellung) gerendert.
        * **Diagramme (SVG) (.zip):** Ein ZIP-Archiv mit allen aktuell sichtbaren Diagrammen als einzelne SVG-Dateien (Vektorformat). Diagramme werden ebenfalls **in englischer Sprache und im Journal-Stil** gerendert.
    * **Export-Pakete (.zip):**
        * **Gesamtpaket (Alle Dateien) (.zip):** B√ºndelt die meisten verf√ºgbaren Einzelfallberichte und Daten (Statistik-CSV, BruteForce-TXT, alle MDs, Rohdaten-CSV, HTML-Report) in einem ZIP-Archiv.
        * **Nur CSVs (.zip):** Alle verf√ºgbaren CSV-Dateien.
        * **Nur Markdown (.zip):** Alle verf√ºgbaren Markdown-Dateien, inklusive der generierten Texte aus dem Publikation-Tab.
        * **Nur Diagramm/Tabellen-PNGs (.zip):** Identisch zum Einzelexport "Diagramme & Tabellen (PNG)".
        * **Nur Diagramm-SVGs (.zip):** Identisch zum Einzelexport "Diagramme (SVG)".
* **Hinweise zum Export:** Ein Informationsbereich erl√§utert die verschiedenen Formate und Besonderheiten (z.B. CSV-Trennzeichen, Abh√§ngigkeit der ZIP-Exporte von sichtbaren Elementen).

## 6. Konfiguration und Einstellungen

Die Anwendung verwendet eine Reihe von internen Konfigurationen und speichert nutzerspezifische Einstellungen im Local Storage des Browsers.

* **Interne Konfigurationen (`js/config/`):**
    * **`app_config.js`:** Enth√§lt globale Anwendungseinstellungen wie Versionsnummer, Standardwerte f√ºr T2-Kriterien, Kollektivauswahl, statistische Konstanten (z.B. Signifikanzniveau, Bootstrap-Replikationen), UI-Einstellungen (z.B. Tooltip-Verz√∂gerung, Toast-Dauer), Basis-Chart-Einstellungen und Export-Dateinamensvorlagen. Enth√§lt auch die Schl√ºsselreferenzen f√ºr die Publikationsgenerierung.
    * **`journal_style_config.js`:** Definiert detaillierte Styling-Parameter (Schriftarten, -gr√∂√üen, Farbpaletten inklusive Graustufen, Linienst√§rken, R√§nder, Exportaufl√∂sungen) speziell f√ºr die Erstellung publikationsreifer Diagramme im "Radiology"-Stil.
    * **`text_config.js`:** Enth√§lt alle sprachabh√§ngigen Texte f√ºr die Benutzeroberfl√§che (Labels, Button-Beschriftungen, Tooltips, Inhalte der Kurzanleitung) in Deutsch und Englisch.
    * **`publication_config.js`:** Definiert die Struktur des Publikation-Tabs, die verf√ºgbaren Literatur-Kriteriensets f√ºr Vergleiche, die Auswahloptionen f√ºr die Brute-Force-Zielmetrik im Publikation-Tab und die IDs sowie Titel der Tabellen und Abbildungen, die im generierten Text referenziert werden.
* **Gespeicherte Nutzereinstellungen (Local Storage):**
    * Die aktuell im "Auswertung"-Tab angewendeten T2-Kriterien und die gew√§hlte Logik.
    * Das zuletzt ausgew√§hlte globale Patientenkollektiv.
    * Die zuletzt gew√§hlte Sprache, Sektion und Brute-Force-Zielmetrik im "Publikation"-Tab.
    * Der zuletzt gew√§hlte Layout-Typ und die Kollektivauswahlen im "Statistik"-Tab.
    * Die zuletzt gew√§hlte Ansicht und T2-Vergleichsbasis im "Pr√§sentation"-Tab.
    * Ein Marker, ob die Kurzanleitung f√ºr die aktuelle Anwendungsversion bereits angezeigt wurde.
    Diese Einstellungen bleiben zwischen Browsersitzungen erhalten, bis der Local Storage gel√∂scht wird.

## 7. Fehlerbehandlung und Hinweise

* Die Anwendung implementiert Fehlerbehandlungsroutinen f√ºr verschiedene Szenarien:
    * Fehler beim Laden von Daten oder bei der Initialisierung von Modulen werden dem Nutzer √ºber Toast-Benachrichtigungen mitgeteilt.
    * Fehler w√§hrend der Brute-Force-Optimierung (z.B. Worker-Fehler, keine Daten) werden im UI des Auswertung-Tabs und als Toast angezeigt.
    * Ung√ºltige Eingaben oder nicht verf√ºgbare Daten f√ºr statistische Berechnungen f√ºhren zur Anzeige von Platzhaltern (z.B. "--", "N/A") in Tabellen und Diagrammen.
* **Wichtiger Hinweis:** Das AvocadoSign Analyse Tool ist ein **Forschungswerkzeug**. Es ist nicht f√ºr die prim√§re klinische Diagnostik oder Behandlungsentscheidungen bei Patienten vorgesehen. Alle Ergebnisse und generierten Texte m√ºssen von qualifiziertem Fachpersonal sorgf√§ltig validiert und interpretiert werden.

## 8. Glossar wichtiger Begriffe

* **AS (Avocado Sign):** Ein spezifisches MRT-Bildgebungsmerkmal von Lymphknoten, das auf T1-gewichteten, fettges√§ttigten, kontrastmittelverst√§rkten Sequenzen beurteilt wird.
* **T2-Kriterien:** Morphologische Merkmale von Lymphknoten, die auf T2-gewichteten MRT-Sequenzen beurteilt werden (z.B. Gr√∂√üe, Form, Kontur, Homogenit√§t, Signalintensit√§t) und zur Vorhersage einer malignen Infiltration dienen.
* **nRCT (neoadjuvante Radiochemotherapie):** Eine Vorbehandlung (Strahlentherapie und Chemotherapie) vor der Operation bei Rektumkarzinom.
* **Direkt OP:** Prim√§re Operation ohne vorherige neoadjuvante Therapie.
* **Sensitivit√§t:** Anteil der tats√§chlich positiven F√§lle, die vom Test korrekt als positiv erkannt werden.
* **Spezifit√§t:** Anteil der tats√§chlich negativen F√§lle, die vom Test korrekt als negativ erkannt werden.
* **PPV (Positiver Pr√§diktiver Wert):** Wahrscheinlichkeit, dass ein positives Testergebnis tats√§chlich auf eine Erkrankung hinweist.
* **NPV (Negativer Pr√§diktiver Wert):** Wahrscheinlichkeit, dass ein negatives Testergebnis tats√§chlich eine Nichterkrankung anzeigt.
* **Accuracy (Gesamtgenauigkeit):** Anteil aller korrekt klassifizierten F√§lle.
* **Balanced Accuracy:** Mittelwert aus Sensitivit√§t und Spezifit√§t; unempfindlicher gegen√ºber ungleichen Gruppengr√∂√üen als die Accuracy.
* **AUC (Area Under the Curve):** Fl√§che unter der ROC-Kurve; Ma√ü f√ºr die generelle Trennsch√§rfe eines Tests. F√ºr bin√§re Tests in dieser Anwendung √§quivalent zur Balanced Accuracy.
* **Brute-Force-Optimierung:** Ein Algorithmus, der systematisch alle m√∂glichen Kombinationen von Kriterien testet, um diejenige zu finden, die eine bestimmte Zielmetrik maximiert.
* **CI (Konfidenzintervall):** Ein Wertebereich, der den wahren (unbekannten) Populationsparameter einer Metrik mit einer bestimmten Wahrscheinlichkeit (hier 95%) √ºberdeckt.
* **McNemar-Test:** Statistischer Test zum Vergleich der Accuracy zweier gepaarter diagnostischer Tests.
* **DeLong-Test:** Statistischer Test zum Vergleich der AUC-Werte zweier gepaarter diagnostischer Tests.
* **Fisher's Exact Test:** Statistischer Test zur Pr√ºfung auf Assoziation zwischen zwei kategorialen Variablen, exakt auch f√ºr kleine Stichproben.
