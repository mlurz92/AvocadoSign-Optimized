# Anwendungsbeschreibung: Lymphknoten T2 - Avocado Sign Analyse Tool v2.5.0

**Autoren:** Dr. med. Markus Lurz & A.O. Schäfer
**Version:** 2.5.0
**Stand:** Mai 2025

## 1. Einleitung

### 1.1 Zweck und Zielsetzung der Anwendung
Das "Lymphknoten T2 - Avocado Sign Analyse Tool" (im Folgenden "Anwendung" genannt) ist eine interaktive Webanwendung, die für die detaillierte Analyse und den wissenschaftlichen Vergleich des "Avocado Signs" (AS) mit T2-gewichteten morphologischen Kriterien zur Prädiktion des mesorektalen Lymphknotenstatus (N-Status) bei Patienten mit Rektumkarzinom entwickelt wurde. Die Anwendung ermöglicht es Forschern, verschiedene Analysemethoden zu evaluieren, Kriterien anzupassen, statistische Auswertungen durchzuführen und Ergebnisse für Präsentationen sowie wissenschaftliche Publikationen aufzubereiten.

Ein Hauptziel dieser Version ist die Unterstützung bei der Erstellung einer wissenschaftlichen Publikation, die das Avocado Sign umfassend mit Literatur-basierten und datengetriebenen, optimierten T2-Kriterien vergleicht, mit Fokus auf eine Einreichung im Journal "Radiology".

### 1.2 Version und Stand
Diese Beschreibung bezieht sich auf die Version 2.5.0 der Anwendung. Sie stellt den aktuellen Entwicklungsstand dar und beinhaltet alle im Folgenden beschriebenen Funktionen und Module.

### 1.3 Zielgruppe
Die Anwendung richtet sich primär an medizinische Forscher, Radiologen und Wissenschaftler, die an der Analyse und Bewertung von Bildgebungsmarkern für das Staging des Rektumkarzinoms beteiligt sind. Insbesondere dient sie den Autoren und Mitwirkenden der Avocado-Sign-Studie als Werkzeug für weiterführende Analysen und die Publikationsvorbereitung.

### 1.4 Wissenschaftliche Grundlage
Die Anwendung und die darin enthaltenen Analysen basieren auf den Erkenntnissen und dem Datensatz der Studie:
* Lurz M, Schäfer AO. The Avocado Sign: A novel imaging marker for nodal staging in rectal cancer. Eur Radiol. 2025. doi:10.1007/s00330-025-11462-y.

Die hier beschriebene Version 2.5.0 dient der Vorbereitung einer Folgestudie, die einen detaillierten Vergleich des Avocado Signs mit verschiedenen etablierten und optimierten T2-gewichteten morphologischen Kriterien zum Gegenstand hat.

## 2. Systemanforderungen und Einrichtung

### 2.1 Browser-Kompatibilität
Die Anwendung ist für die Nutzung in modernen Webbrowsern optimiert. Empfohlen werden aktuelle Versionen von:
* Google Chrome
* Mozilla Firefox
* Microsoft Edge
* Apple Safari

Die Funktionalität in älteren Browsern oder Internet Explorer ist nicht gewährleistet.

### 2.2 Notwendige Bibliotheken (CDN-Nutzung)
Die Anwendung nutzt verschiedene JavaScript-Bibliotheken und CSS-Frameworks, die über Content Delivery Networks (CDNs) eingebunden werden. Eine lokale Installation dieser Bibliotheken ist für die reine Nutzung nicht erforderlich. Zu den externen Bibliotheken gehören: Bootstrap 5.3, D3.js v7, Tippy.js & Popper.js, PapaParse, JSZip, Font Awesome und html2canvas.

### 2.3 Lokale Ausführung
Die Anwendung kann direkt durch Öffnen der Datei `index.html` in einem kompatiblen Webbrowser von einem lokalen Dateisystem gestartet werden. Es ist keine serverseitige Komponente oder spezielle Installationsprozedur notwendig.

## 3. Globale Konzepte der Benutzeroberfläche (UI)

Die Benutzeroberfläche der Anwendung ist darauf ausgelegt, eine intuitive Bedienung und einen effizienten Workflow für komplexe Datenanalysen zu ermöglichen.

### 3.1 Hauptlayout
Das Hauptlayout der Anwendung gliedert sich in vier Bereiche:
* **Header-Bereich:** Am oberen Bildschirmrand fixiert, enthält den Anwendungstitel, globale Bedienelemente und eine dynamische Statistikübersicht.
* **Hauptnavigation (Tab-System):** Unterhalb des Headers, ebenfalls fixiert, ermöglicht den Wechsel zwischen den Hauptmodulen der Anwendung.
* **Inhaltsbereich:** Der zentrale Bereich, in dem die Inhalte des jeweils aktiven Tabs dargestellt werden.
* **Footer-Bereich:** Am unteren Bildschirmrand, enthält Copyright-Informationen und weiterführende Links.

### 3.2 Header-Bereich

#### 3.2.1 App-Titel und Version
Links im Header wird der Titel der Anwendung ("Lymphknoten T2 & Avocado Sign Analyse") sowie die aktuelle Versionsnummer (z.B. "v2.5.0") angezeigt.

#### 3.2.2 Globale Kollektivauswahl
In der Mitte des Headers befindet sich eine Button-Gruppe zur Auswahl des globalen Patientenkollektivs für alle Analysen:
* **Gesamt:** Alle Patienten (N=106).
* **Direkt OP:** Nur Patienten, die primär operiert wurden (N=29).
* **nRCT:** Nur Patienten, die neoadjuvant radiochemotherapeutisch vorbehandelt wurden (N=77).
Der jeweils aktive Button ist farblich hervorgehoben. Eine Änderung des Kollektivs aktualisiert dynamisch alle relevanten Datenansichten, Statistiken und Diagramme in der gesamten Anwendung.

#### 3.2.3 Interaktive Header-Statistiken
Unterhalb der Kollektivauswahl werden dynamische Kurzübersichten zum aktuellen Status des gewählten Kollektivs angezeigt:
* **Patientenanzahl:** Gesamtzahl der Patienten im aktiven Kollektiv.
* **N-Status:** Verteilung der Patienten mit positivem (N+) vs. negativem (N-) histopathologischem Lymphknotenstatus.
* **AS-Status:** Verteilung der Patienten mit positivem (AS+) vs. negativem (AS-) Avocado Sign.
* **T2-Status:** Verteilung der Patienten mit positivem (T2+) vs. negativem (T2-) Lymphknotenstatus gemäß den aktuell im Tab "Auswertung" definierten und angewendeten T2-Kriterien.
Diese Statistiken bieten einen schnellen Überblick und ändern sich dynamisch mit der Kollektivauswahl und der Anwendung neuer T2-Kriterien.

#### 3.2.4 Design-Umschalter (Hell/Dunkel)
Rechts im Header befindet sich ein Button (Mond-/Sonnensymbol), der das Umschalten zwischen einem hellen und einem dunklen Design (Theme) der Benutzeroberfläche ermöglicht. Die gewählte Einstellung wird im `localStorage` gespeichert und beim nächsten Start wiederhergestellt.

#### 3.2.5 Kurzanleitung-Button
Ein Info-Button (<i class="fas fa-info-circle"></i>) rechts im Header öffnet ein modales Fenster mit einer Kurzanleitung zur Bedienung der Anwendung und wichtigen Hinweisen.

### 3.3 Hauptnavigation (Tab-System)
Die Hauptnavigation erfolgt über ein horizontales Tab-System unterhalb des Headers. Folgende Tabs stehen zur Verfügung:
* **Daten:** Anzeige der Rohdaten.
* **Auswertung:** Definition von T2-Kriterien, Brute-Force-Optimierung und Ergebnisübersicht.
* **Statistik:** Detaillierte statistische Analysen.
* **Präsentation:** Aufbereitete Ergebnisse für Vorträge.
* **Publikation:** Generierung eines wissenschaftlichen Publikationsentwurfs.
* **Export:** Download von Daten und Ergebnissen.
Der jeweils aktive Tab ist visuell hervorgehoben. Ein Klick auf einen Tab-Reiter wechselt in das entsprechende Modul und aktualisiert den Inhaltsbereich. Der zuletzt aktive Tab wird gespeichert und beim Neuladen der Anwendung wiederhergestellt.

### 3.4 Tooltips und Hilfestellungen
Viele interaktive Elemente der Benutzeroberfläche (Buttons, Eingabefelder, Auswahlmenüs, Diagrammelemente) sind mit Tooltips versehen. Diese erscheinen, wenn der Mauszeiger über das Element bewegt wird, und bieten kontextsensitive Erklärungen zur Funktion oder Bedeutung des Elements. Sie basieren auf der Tippy.js-Bibliothek.

### 3.5 Benachrichtigungen (Toasts)
Die Anwendung verwendet Toast-Benachrichtigungen, um dem Nutzer Feedback über erfolgreich durchgeführte Aktionen (z.B. Speichern von Einstellungen, Datenexport) oder aufgetretene Fehler und Warnungen zu geben. Diese erscheinen typischerweise am unteren rechten Bildschirmrand und verschwinden nach kurzer Zeit automatisch.

### 3.6 Modale Dialoge
Für komplexere Interaktionen oder die Darstellung umfangreicher Informationen werden modale Dialogfenster verwendet:
* **Brute-Force-Ergebnis-Modal:** Zeigt die Top-10 Ergebnisse einer abgeschlossenen Brute-Force-Optimierung an.
* **Info-Modal:** Wird für die Kurzanleitung und potenziell andere informative Inhalte genutzt.
Modale Dialoge überlagern den Hauptinhalt und müssen aktiv geschlossen werden.

### 3.7 Zustandsspeicherung (Local Storage)
Verschiedene Einstellungen und Zustände der Anwendung werden im `localStorage` des Browsers gespeichert. Dazu gehören:
* Aktuell angewandte T2-Kriterien und Logik.
* Ausgewähltes globales Kollektiv.
* Einstellungen für den Publikation-Tab (Sprache, Sektion, BF-Metrik).
* Einstellungen für den Statistik-Tab (Layout, Vergleichskollektive).
* Einstellungen für den Präsentation-Tab (Ansicht, Studien-ID).
* Ausgewählte Kriteriensets für den Kriterienvergleich.
* Gewähltes Farbschema für Diagramme.
* Zuletzt aktiver Tab.
* Gewähltes UI-Theme (Hell/Dunkel).
Dies ermöglicht es, dass die Anwendungseinstellungen bei einem erneuten Besuch der Seite wiederhergestellt werden. Die Speicher-Schlüssel sind versioniert (aktuell `_v2.5.0`), um Konflikte bei Anwendungsupdates zu minimieren.

## 4. Detaillierte Beschreibung der Anwendungsmodule (Tabs)

### 4.1 Tab: Daten

#### 4.1.1 Zweck und Inhalt
Der "Daten"-Tab dient der Anzeige der zugrundeliegenden (pseudonymisierten) Patientendaten des aktuell ausgewählten globalen Kollektivs. Er bietet eine tabellarische Übersicht über Basisinformationen sowie den pathologischen N-Status, den Avocado-Sign-Status und den T2-Status (basierend auf aktuell angewandten Kriterien).

#### 4.1.2 Tabellenansicht (Patientenliste)
Die Hauptkomponente ist eine sortierbare Tabelle mit folgenden Spalten:
* **Nr.:** Fortlaufende, interne Nummer des Patienten.
* **Name:** Nachname des Patienten (pseudonymisiert).
* **Vorname:** Vorname des Patienten (pseudonymisiert).
* **Geschl.:** Geschlecht des Patienten (m, w, unbekannt).
* **Alter:** Alter des Patienten in Jahren zum Zeitpunkt der MRT.
* **Therapie:** Art der Vorbehandlung (Direkt OP, nRCT).
* **N / AS / T2:** Direkter Vergleich des pathologischen N-Status ('+' oder '-'), des Avocado-Sign-Status ('+' oder '-') und des T2-Status ('+' oder '-') für den Patienten. Ein Klick auf die Spaltenköpfe N, AS oder T2 ermöglicht eine Sub-Sortierung nach dem jeweiligen Status.
* **Bemerkung:** Zusätzliche klinische oder radiologische Anmerkungen zum Fall.
* **(Aktion):** Ein Pfeil-Icon (<i class="fas fa-chevron-right"></i> / <i class="fas fa-chevron-down"></i>) zum Aufklappen einer Detailansicht.

**Sortierfunktionen:** Die Tabelle kann durch Klick auf die meisten Spaltenüberschriften auf- oder absteigend sortiert werden. Ein Pfeilsymbol in der Spaltenüberschrift zeigt die aktuelle Sortierrichtung an.

**Detailansicht für Lymphknoten:** Durch Klick auf das Pfeil-Icon in einer Zeile (oder den "Alle Aufklappen"-Button) kann eine Detailansicht für den jeweiligen Patienten geöffnet werden. Diese zeigt eine Untertabelle mit den morphologischen Eigenschaften (Größe, Form, Kontur, Homogenität, Signal) aller im T2-gewichteten MRT erfassten Lymphknoten dieses Patienten.

#### 4.1.3 Interaktionsmöglichkeiten
* **Tabellensortierung:** Wie oben beschrieben.
* **Zeilen aufklappen/zuklappen:** Einzeln oder global über den "Alle Aufklappen/Zuklappen"-Button oberhalb der Tabelle.
* **Pagination:** Die Tabelle verfügt über eine Paginierung am unteren Rand, um durch große Datensätze zu navigieren und die Anzahl der pro Seite angezeigten Einträge anzupassen.
* **Suchfunktion:** Ein Suchfeld oberhalb der Tabelle ermöglicht das Filtern der angezeigten Patienten nach Name, Vorname oder Nummer.

### 4.2 Tab: Auswertung

#### 4.2.1 Zweck und Inhalt
Der "Auswertung"-Tab ist das zentrale Modul für die Interaktion mit den T2-gewichteten Kriterien. Hier können Nutzer:
* Ein Dashboard mit deskriptiven Statistiken und Diagrammen zum aktuellen Kollektiv einsehen.
* T2-Malignitätskriterien flexibel definieren und anwenden.
* Eine Kurzübersicht der diagnostischen Güte der angewandten T2-Kriterien erhalten.
* Eine Brute-Force-Optimierung zur Findung optimaler T2-Kriterien starten.
* Eine detaillierte Auswertungstabelle einsehen, die jeden Patienten mit seinem N-, AS- und (angewandten) T2-Status sowie Lymphknotenzahlen anzeigt.

#### 4.2.2 Dashboard
Am oberen Rand des Tabs befindet sich ein Dashboard, das aus mehreren Kacheln (Cards) besteht und eine schnelle Übersicht über das aktuelle Kollektiv bietet:
* **Altersverteilung:** Histogramm der Altersverteilung.
* **Geschlecht:** Tortendiagramm der Geschlechterverteilung.
* **Therapie:** Tortendiagramm der Verteilung der Therapieformen (Direkt OP vs. nRCT).
* **N-Status (Patho):** Tortendiagramm zur Verteilung des pathologischen N-Status.
* **AS-Status:** Tortendiagramm zur Verteilung des Avocado-Sign-Status.
* **T2-Status (angewandt):** Tortendiagramm zur Verteilung des T2-Status basierend auf den aktuell angewandten Kriterien.
Jede Kachel kann Diagramme als PNG oder SVG herunterladen.

#### 4.2.3 T2-Malignitätskriterien-Definition
Diese Sektion ("T2 Malignitäts-Kriterien Definieren") ermöglicht die detaillierte Konfiguration der T2-Kriterien:
* **Logik-Umschalter:** Ein Schalter (Checkbox-Stil) oben rechts in der Kriterien-Karte erlaubt die Wahl der logischen Verknüpfung der aktivierten Kriterien:
    * **UND:** Ein Lymphknoten gilt nur als T2-positiv, wenn *alle* aktivierten Kriterien erfüllt sind.
    * **ODER:** Ein Lymphknoten gilt als T2-positiv, wenn *mindestens ein* aktiviertes Kriterium erfüllt ist.
    Der aktuell gewählte Logik-Operator wird daneben angezeigt.
* **Größenkriterium:**
    * **Aktivierung:** Eine Checkbox aktiviert/deaktiviert das Größenkriterium.
    * **Schwellenwert:** Ein Range-Slider und ein numerisches Eingabefeld ermöglichen die Einstellung des Kurzachsendurchmesser-Schwellenwerts (in mm, von 0.1 bis 25.0 mm in 0.1mm Schritten). Lymphknoten mit einem Durchmesser **größer oder gleich (≥)** dem eingestellten Wert gelten als suspekt, wenn das Kriterium aktiv ist.
* **Morphologische Kriterien (Form, Kontur, Homogenität, Signal):**
    * Für jedes dieser vier Merkmale gibt es eine eigene Gruppe.
    * **Aktivierung:** Eine Checkbox aktiviert/deaktiviert das jeweilige Merkmal als Kriterium.
    * **Werteauswahl:** Buttons mit Icons repräsentieren die möglichen Ausprägungen des Merkmals (z.B. für Form: "rund", "oval"). Der Nutzer wählt durch Klick auf einen Button die als suspekt geltende Ausprägung aus. Nur wenn das Kriterium aktiv ist, kann eine Ausprägung gewählt werden. Der aktive Button ist farblich hervorgehoben.
* **Buttons:**
    * **"Zurücksetzen (Standard)":** Setzt die Logik und alle Kriterien auf die in `app_config.js` definierten Standardwerte zurück. Die Änderungen sind danach noch *nicht* angewendet.
    * **"Anwenden & Speichern":** Wendet die aktuell eingestellten T2-Kriterien und die Logik auf den gesamten Datensatz an. Dies aktualisiert die T2-Spalten in allen Tabellen, alle statistischen Auswertungen und Diagramme in der gesamten Anwendung. Die Einstellungen werden zudem im `localStorage` gespeichert.
* **Indikator für ungespeicherte Änderungen:** Ein kleiner farbiger Punkt (Warnfarbe) neben dem Titel "T2 Malignitäts-Kriterien Definieren" erscheint, wenn Änderungen an den Kriterien oder der Logik vorgenommen, aber noch nicht durch "Anwenden & Speichern" übernommen wurden.

#### 4.2.4 Kurzübersicht Diagnostische Güte T2
Unterhalb der Kriteriendefinition wird eine kompakte Übersicht der diagnostischen Gütemetriken (Sens, Spez, PPV, NPV, LR+, LR-, Acc, BalAcc/AUC, F1) für die *aktuell angewandten und gespeicherten* T2-Kriterien im Vergleich zum N-Status für das global gewählte Kollektiv angezeigt. Jeder Wert wird mit seinem 95%-Konfidenzintervall dargestellt. Die Tooltips bieten detaillierte Erklärungen und Interpretationen.

#### 4.2.5 Kriterien-Optimierung (Brute-Force)
Diese Sektion ("Kriterien-Optimierung (Brute-Force)") ermöglicht die automatische Suche nach optimalen T2-Kriterien:
* **Auswahl der Zielmetrik:** Ein Dropdown-Menü erlaubt die Auswahl der Metrik, die durch den Algorithmus maximiert werden soll (z.B. Balanced Accuracy, Accuracy, F1-Score, PPV, NPV).
* **Starten der Optimierung:** Der Button "<i class="fas fa-cogs"></i> Optimierung starten" initiiert den Brute-Force-Suchprozess. Dieser testet systematisch alle sinnvollen Kombinationen der T2-Merkmalsausprägungen und der Logik (UND/ODER) sowie verschiedene Größenschwellenwerte. Der Prozess läuft in einem separaten Web Worker, um die Benutzeroberfläche nicht zu blockieren. Der Button ist deaktiviert, falls der Worker nicht initialisiert werden konnte.
* **Status- und Kollektiv-Anzeige:** Zeigt den aktuellen Status des Workers ("Bereit", "Läuft", "Abgeschlossen", "Fehler") und das Patientenkollektiv, für das die Optimierung durchgeführt wird.
* **Fortschrittsanzeige (während der Optimierung):**
    * Zeigt die Anzahl der bereits getesteten Kombinationen im Verhältnis zur Gesamtanzahl und den prozentualen Fortschritt.
    * Ein Fortschrittsbalken visualisiert dies.
    * Die aktuell beste gefundene Metrik und die zugehörigen Kriterien werden live angezeigt.
    * Ein "Abbrechen"-Button erscheint, um den laufenden Prozess vorzeitig zu beenden.
* **Ergebnisanzeige (nach Abschluss):**
    * Eine Erfolgsmeldung zeigt die beste gefundene Kriterienkombination, deren Logik und den erreichten Wert der Zielmetrik.
    * Die Dauer der Optimierung und die Anzahl der getesteten Kombinationen werden angezeigt.
    * Statistiken zum verwendeten Kollektiv (N, N+, N-) werden eingeblendet.
    * **"Anwenden"-Button:** Übernimmt die beste gefundene Kombination in die T2-Kriteriendefinition und wendet sie sofort an (analog zu "Anwenden & Speichern").
    * **"Top 10"-Button:** Öffnet ein modales Fenster mit einer detaillierten Tabelle der besten 10 (oder mehr bei gleichen Werten) gefundenen Kriterienkombinationen und ihren jeweiligen Performance-Metriken (Sens, Spez, PPV, NPV). Dieser Bericht kann als TXT-Datei exportiert werden.

#### 4.2.6 Auswertungstabelle
Am unteren Ende des "Auswertung"-Tabs befindet sich eine detaillierte Tabelle, die für jeden Patienten im aktuellen globalen Kollektiv folgende Informationen anzeigt:
* **Nr., Name, Therapie:** Wie im "Daten"-Tab.
* **N / AS / T2:** Direkter Statusvergleich (Pathologie, Avocado Sign, aktuell angewandte T2-Kriterien).
* **N+/N ges.:** Anzahl pathologisch positiver Lymphknoten / Gesamtzahl untersuchter Lymphknoten für diesen Patienten.
* **AS+/AS ges.:** Anzahl AS-positiver Lymphknoten / Gesamtzahl sichtbarer Lymphknoten im T1KM-MRT.
* **T2+/T2 ges.:** Anzahl T2-positiver Lymphknoten (gemäß aktuell angewandter Kriterien) / Gesamtzahl sichtbarer Lymphknoten im T2-MRT.
* **(Aktion):** Ein Pfeil-Icon zum Aufklappen einer Detailansicht. Diese zeigt für jeden T2-gewichteten Lymphknoten des Patienten die erfassten morphologischen Merkmale und eine Markierung, welche der aktuell angewandten T2-Positiv-Kriterien erfüllt sind.
Die Tabelle ist ebenfalls sortierbar und paginiert und verfügt über eine Suchfunktion und einen "Alle Aufklappen/Zuklappen"-Button.

### 4.3 Tab: Statistik

#### 4.3.1 Zweck und Inhalt
Der "Statistik"-Tab dient der Durchführung und Anzeige detaillierter statistischer Analysen zur Bewertung der diagnostischen Güte des Avocado Signs und der T2-Kriterien sowie deren Vergleich. Alle Analysen beziehen sich auf das global gewählte Kollektiv oder auf spezifisch für den Vergleich ausgewählte Kollektive. Alle Konfidenzintervalle (CI) sind, falls nicht anders angegeben, 95%-Konfidenzintervalle.

#### 4.3.2 Layout-Auswahl
Ein Button ("Einzelansicht" / "Vergleich Aktiv") am oberen Rand des Statistik-Tabs ermöglicht den Wechsel zwischen zwei Hauptansichten:
* **Einzelansicht:** Alle Analysen werden für das aktuell im Header global ausgewählte Patientenkollektiv durchgeführt.
* **Vergleich Aktiv:** Es erscheinen zwei Dropdown-Menüs, mit denen zwei spezifische Kollektive (z.B. "Direkt OP" und "nRCT") für einen direkten statistischen Vergleich ihrer Performance-Metriken ausgewählt werden können.

#### 4.3.3 Kollektivauswahl für Vergleich
Nur im Layout "Vergleich Aktiv" sichtbar. Zwei Dropdown-Menüs ("Kollektiv 1", "Kollektiv 2") erlauben die Auswahl der zu vergleichenden Kollektive aus den verfügbaren Optionen (Gesamt, Direkt OP, nRCT).

#### 4.3.4 Deskriptive Statistik (Detailliert)
Eine Kachel ("Deskriptive Statistik") zeigt detaillierte demographische und klinische Daten sowie Basis-Lymphknotenzahlen für das (im Einzelansichtsmodus global oder im Vergleichsmodus für Kollektiv 1) ausgewählte Kollektiv. Dies umfasst:
* Alter (Median, Min-Max, Mean ± SD).
* Geschlechterverteilung (n, %).
* Therapieverteilung (n, %).
* Verteilung des N-, AS- und T2-Status (n, %).
* Statistiken zur Anzahl der Lymphknoten (gesamte, positive) für N, AS und T2 (Median, Min-Max, Mean ± SD).
Zusätzlich werden Diagramme zur Alters- und Geschlechterverteilung angezeigt, die als PNG/SVG exportiert werden können. Die gesamte Tabelle kann als Markdown exportiert werden.

#### 4.3.5 Diagnostische Güte: Avocado Sign
Eine Kachel ("Diagnostische Güte: Avocado Sign (AS) vs. N") zeigt die Performance-Metriken für das Avocado Sign im Vergleich zum pathologischen N-Status für das aktuell betrachtete Kollektiv. Dargestellt werden: Sensitivität, Spezifität, PPV, NPV, LR+, LR-, Accuracy, Balanced Accuracy (AUC) und F1-Score, jeweils mit 95%-KI. Tooltips erläutern jede Metrik und deren Interpretation. Die zugrundeliegende 2x2-Kontingenztafel (Konfusionsmatrix) wird ebenfalls angezeigt.

#### 4.3.6 Diagnostische Güte: Angewandte T2-Kriterien
Analog zur Avocado-Sign-Kachel zeigt diese Kachel ("Diagnostische Güte: T2 (angewandt) vs. N") dieselben Performance-Metriken für die aktuell im "Auswertung"-Tab definierten und angewendeten T2-Kriterien.

#### 4.3.7 Statistischer Vergleich: AS vs. Angewandte T2-Kriterien
Diese Kachel ("Statistischer Vergleich: AS vs. T2 (angewandt)") präsentiert die Ergebnisse gepaarter statistischer Tests zum direkten Vergleich der diagnostischen Leistung des Avocado Signs mit den aktuell angewandten T2-Kriterien für dasselbe Kollektiv:
* **McNemar-Test:** Zum Vergleich der Accuracy (basierend auf diskordanten Paaren).
* **DeLong-Test:** Zum Vergleich der AUC-Werte.
Für jeden Test werden die Teststatistik (falls relevant), der p-Wert und eine Angabe zur Signifikanz angezeigt.

#### 4.3.8 Assoziation Einzelkriterien mit N-Status
Diese Kachel ("Assoziation mit N-Status (T2-Merkmale & AS)") analysiert den Zusammenhang zwischen dem Vorhandensein des Avocado Signs bzw. einzelner T2-Merkmale (basierend auf den aktuell angewandten Kriterien und Schwellenwerten) und dem pathologischen N-Status:
* Für jedes Merkmal werden die 2x2-Kontingenztafel, Odds Ratio (OR) mit 95%-KI, Risk Difference (RD) mit 95%-KI und der Phi-Koeffizient (φ) berechnet.
* Der p-Wert für den Zusammenhang wird mittels Fisher's Exact Test ermittelt.
* Zusätzlich wird die Verteilung der Lymphknotengrößen zwischen N+ und N- Patienten mittels Mann-Whitney-U-Test verglichen.

#### 4.3.9 Vergleich zwischen Kollektiven (Accuracy, AUC)
Diese Kachel ist nur im Layout "Vergleich Aktiv" sichtbar ("Vergleich zw. Kollektiven ([Koll1] vs. [Koll2])"). Sie zeigt:
* Den statistischen Vergleich der Accuracy (mittels Fisher's Exact Test) für das Avocado Sign zwischen den beiden ausgewählten Kollektiven.
* Den statistischen Vergleich der AUC (mittels Z-Test) für das Avocado Sign zwischen den beiden Kollektiven.
* Analoge Vergleiche für die aktuell angewandten T2-Kriterien.
P-Werte und Signifikanzangaben werden bereitgestellt.

#### 4.3.10 Tabellarischer Kriterienvergleich
Diese Kachel ("Kriterienvergleich (Übersicht)") bietet eine tabellarische Zusammenfassung der wichtigsten diagnostischen Gütemetriken (Sens, Spez, PPV, NPV, Acc, AUC) für das Avocado Sign, die aktuell angewandten T2-Kriterien sowie für die vordefinierten Literatur-Kriteriensets (Koh et al., Barbaro et al., ESGAR 2016). Die Literatur-Sets werden dabei auf ihrem jeweils relevanten Zielkollektiv (oder dem globalen Kollektiv, falls zutreffend) evaluiert. Die Tabelle dient einem schnellen Überblick und Vergleich der verschiedenen Ansätze. Konfidenzintervalle werden hier aus Platzgründen nicht dargestellt.

### 4.4 Tab: Präsentation

#### 4.4.1 Zweck und Inhalt
Der "Präsentation"-Tab dient der Aufbereitung und Darstellung von Analyseergebnissen in einem Format, das sich besonders gut für Vorträge und Präsentationen eignet. Er fokussiert auf den Vergleich des Avocado Signs mit T2-basierten Ansätzen.

#### 4.4.2 Ansichtsauswahl
Links oben kann über ein Dropdown-Menü die Hauptansicht des Tabs gewählt werden:
* **Avocado Sign (Performance):** Zeigt eine Übersicht der Performance-Metriken des Avocado Signs für die drei Hauptkollektive (Gesamt, Direkt OP, nRCT) sowie demographische Basisdaten.
* **AS vs. T2 (Vergleich):** Ermöglicht den direkten Vergleich des Avocado Signs mit einer auswählbaren T2-Kriterienbasis.

#### 4.4.3 Auswahl der T2-Vergleichsbasis (nur in Ansicht "AS vs. T2 Vergleich")
Wenn die Vergleichsansicht aktiv ist, erscheint ein weiteres Dropdown-Menü ("T2-Basis für Vergleich"). Hier kann der Nutzer wählen, womit das Avocado Sign verglichen werden soll:
* **Aktuell angewandte T2-Kriterien:** Die im "Auswertung"-Tab definierten Kriterien.
* **Literatur-Kriteriensets:** Die vordefinierten Sets von Koh et al. (2008), Barbaro et al. (2024) oder ESGAR 2016 (Rutegård et al. 2025).
Die Auswahl einer T2-Basis aktualisiert dynamisch die angezeigten Vergleichsdaten und Diagramme. Das für den Vergleich herangezogene Patientenkollektiv passt sich ggf. automatisch an das Zielkollektiv der ausgewählten Literaturstudie an (z.B. nRCT-Kollektiv für Barbaro et al.).

#### 4.4.4 Informationskarte zur T2-Basis (nur in Ansicht "AS vs. T2 Vergleich")
Zeigt Details zur aktuell ausgewählten T2-Vergleichsbasis, wie die Studienreferenz, die ursprüngliche Studienkohorte, die Art der Untersuchung und eine Zusammenfassung der Schlüsselkriterien.

#### 4.4.5 Dargestellte Tabellen und Diagramme
Abhängig von der gewählten Ansicht und T2-Basis werden verschiedene aufbereitete Inhalte angezeigt:
* **Ansicht "Avocado Sign (Performance)":**
    * Tabelle mit demographischen Basisdaten (Patientenzahl, Alter, Geschlecht, N-Status für Gesamt, Direkt OP, nRCT).
    * Tabelle mit Performance-Metriken (Sens, Spez, PPV, NPV, Acc, AUC) des Avocado Signs für jedes der drei Kollektive.
* **Ansicht "AS vs. T2 (Vergleich)":**
    * Tabelle mit einer numerischen Gegenüberstellung der diagnostischen Gütemetriken (Sens, Spez, etc. mit 95%-KI) für das Avocado Sign versus die ausgewählte T2-Basis, bezogen auf das relevante Vergleichskollektiv.
    * Tabelle mit den Ergebnissen der statistischen Vergleichstests (McNemar für Accuracy, DeLong für AUC) zwischen AS und der T2-Basis.
    * Ein Balkendiagramm, das ausgewählte Performance-Metriken (z.B. Sens, Spez, AUC) für AS und die T2-Basis visuell vergleicht.

#### 4.4.6 Exportoptionen für Präsentationsinhalte
Für die meisten angezeigten Tabellen und Diagramme im Präsentation-Tab stehen direkte Exportoptionen zur Verfügung (Buttons neben den Elementen):
* Tabellen: Export als CSV und Markdown. In einigen Fällen auch als PNG.
* Diagramme: Export als PNG und SVG.

### 4.5 Tab: Publikation

#### 4.5.1 Zweck und erweiterter Nutzen
Der "Publikation"-Tab ist ein Kernmodul dieser Anwendungsversion (v2.5.0) und wurde signifikant erweitert. Sein Hauptzweck ist die Unterstützung bei der Erstellung einer wissenschaftlichen Publikation, die das Avocado Sign mit Literatur-basierten und Brute-Force-optimierten T2-Kriterien vergleicht. Das Tool generiert einen umfassenden Erstentwurf, der sich im Stil und in der Struktur an den Anforderungen des Journals "Radiology" orientiert.

#### 4.5.2 Hauptfunktionen
* **Generierung eines strukturierten Entwurfs:** Die Anwendung erstellt detaillierte und formulierte Textvorschläge für die Sektionen **"Methoden"** und **"Ergebnisse"** der Publikation.
* **Platzhalter und Hinweise:** Für die Sektionen Abstract, Einleitung, Diskussion und Schlussfolgerung werden strukturelle Gliederungspunkte und kurze Hinweise generiert, die zur manuellen Ausarbeitung durch den Nutzer anleiten. Die inhaltliche Ausformulierung dieser Teile obliegt dem Autor, der Generator liefert hier lediglich das Grundgerüst.
* **Dynamische Inhalte:** Die generierten Texte basieren auf den aktuellen Analysedaten aus `allKollektivStats`, den globalen Einstellungen und dem für die Publikation gewählten Brute-Force-Optimierungsziel.
* **Automatische Referenzierung:** Tabellen und Abbildungen, die für die Publikation relevant sind und deren Darstellung im Ergebnisteil vorgesehen ist, werden im Text automatisch korrekt referenziert (z.B. "siehe Tabelle 1", "Abbildung 2A zeigt...").
* **Dynamische Referenzliste:** Alle im Methoden- und Ergebnisteil zitierten Literaturstellen (aus `APP_CONFIG.REFERENCES_FOR_PUBLICATION`) werden automatisch gesammelt und am Ende als formatierte, nummerierte Referenzliste im Vancouver-Stil ausgegeben.

#### 4.5.3 Bedienelemente
Der Kopfbereich des Publikation-Tabs enthält folgende Bedienelemente:
* **Sektionsnavigation (links):** Eine vertikale Navigationsleiste listet alle Hauptsektionen einer typischen wissenschaftlichen Publikation auf (Abstract, Einleitung, Methoden, Ergebnisse, Diskussion, Schlussfolgerung, Referenzen). Ein Klick auf einen Sektionsnamen lädt den entsprechenden Inhalt in den Hauptanzeigebereich.
* **Auswahl der Brute-Force-Metrik für Ergebnisdarstellung (rechts oben):** Ein Dropdown-Menü ermöglicht die Auswahl der Zielmetrik (z.B. Balanced Accuracy, F1-Score), deren Brute-Force-Optimierungsergebnisse im Ergebnisteil der generierten Publikation verwendet und diskutiert werden sollen. Die Auswahl beeinflusst die generierten Texte und Tabelleninhalte bezüglich der optimierten T2-Kriterien.
* **Sprachumschaltung (Deutsch/Englisch, rechts oben):** Ein Schalter erlaubt das Wechseln der Sprache für die generierten Texte und einige Beschriftungen.

#### 4.5.4 Inhaltsbereich
Der zentrale Inhaltsbereich zeigt den Text und die Elemente der aktuell ausgewählten Publikationssektion:
* **Dynamisch generierter Text:** Der Fließtext für Methoden und Ergebnisse wird von `publicationTextGenerator.js` erzeugt. Er enthält formatierte statistische Werte, Konfidenzintervalle und p-Werte.
* **Tabellen und Abbildungen:**
    * Platzhalter-`div`-Elemente für relevante Tabellen (Patientencharakteristika, Literatur-Kriterien, Performance-Tabellen für AS, Lit-T2, BF-T2, Vergleichstabellen) und Abbildungen (Demographie-Diagramme, Performance-Vergleichsdiagramme) werden an den entsprechenden Stellen im Textfluss oder als eigene Unterabschnitte gerendert.
    * Diese Platzhalter werden dynamisch durch `publikation_tab_logic.js` mit den tatsächlichen HTML-Tabellen (generiert von `publication_renderer.js`) und SVG-Diagrammen (generiert von `chart_renderer.js`) befüllt.
    * Konzeptuelle Abbildungen (z.B. Beipielbilder des Avocado Signs) werden als Platzhalter mit Beschriftungshinweis gerendert und müssen manuell durch den Autor eingefügt werden.
Der gesamte Inhaltsbereich ist bei Bedarf scrollbar.

### 4.6 Tab: Export

#### 4.6.1 Zweck und Inhalt
Der "Export"-Tab bündelt alle Download-Funktionalitäten der Anwendung. Er ermöglicht den Export von Rohdaten, Analyseergebnissen, Tabellen, Diagrammen und Publikationsentwürfen in verschiedenen Dateiformaten. Alle Exporte basieren auf dem aktuell im Header gewählten globalen Kollektiv und den zuletzt im "Auswertung"-Tab angewendeten T2-Kriterien.

#### 4.6.2 Einzelexporte
Folgende Daten können als einzelne Dateien heruntergeladen werden:
* **Berichte & Statistiken:**
    * Statistik Ergebnisse (detailliert, aus Statistik-Tab) als CSV.
    * Brute-Force Bericht (Top 10 Ergebnisse, Konfiguration) als TXT.
    * Deskriptive Statistik (aus Statistik-Tab) als Markdown (MD).
    * Umfassender Analysebericht (Konfiguration, Statistiken, eingebettete Diagramme) als HTML.
    * **Publikationsentwurf (Methoden & Ergebnisse, Platzhalter für Rest) als Markdown (MD).**
    * **Publikationsentwurf (Methoden & Ergebnisse, Platzhalter für Rest) als HTML.**
* **Tabellen & Rohdaten:**
    * Datenliste (aus Daten-Tab) als MD.
    * Auswertungstabelle (aus Auswertung-Tab) als MD.
    * Gefilterte Rohdaten des aktuellen Kollektivs als CSV.
* **Diagramme & Tabellen (als Bilder):**
    * Optionen zum Download aller aktuell im UI sichtbaren Diagramme und ausgewählter Tabellen als einzelne PNG-, SVG- oder **TIFF-Dateien (experimentell, basiert auf PNG-Konvertierung)**. Diese werden als ZIP-Archiv gebündelt. Einzelne Diagramme/Tabellen können auch direkt an ihrem Anzeigeort heruntergeladen werden.

#### 4.6.3 Export-Pakete (ZIP-Archive)
Mehrere thematisch zusammengehörige Exportdateien können als einzelnes ZIP-Archiv heruntergeladen werden:
* **Gesamtpaket (Alle Dateien):** Enthält die meisten verfügbaren Einzel-Exporte (CSVs, MDs, TXT, HTML-Report, Publikationsentwürfe).
* **Nur CSVs:** Alle verfügbaren CSV-Dateien.
* **Nur Markdown:** Alle verfügbaren Markdown-Dateien (inkl. Publikationsentwurf).
* **Nur Diagramm/Tabellen-PNGs:** Wie oben beschrieben.
* **Nur Diagramm-SVGs:** Wie oben beschrieben.

#### 4.6.4 Hinweise zum Export
Ein Hinweisfeld erläutert die verschiedenen Dateiformate und deren typische Verwendung sowie Besonderheiten beim Export von Diagramm-Paketen.

## 5. Datenmanagement und -grundlage

### 5.1 Verwendeter Datensatz
Die Anwendung verwendet einen statischen, integrierten Datensatz von **N=106 Patienten** mit Rektumkarzinom. Dieser Datensatz wurde prospektiv am Klinikum St. Georg, Leipzig, im Zeitraum Januar 2020 bis November 2023 erfasst und ist die Basis der initialen Avocado-Sign-Studie ${referenceManager.cite('LURZ_SCHAEFER_2025')}$. Die Daten sind in der Datei `data/data.js` hinterlegt.

### 5.2 Datenstruktur
Jeder Patientendatensatz enthält:
* **Basisinformationen:** Pseudonymisierte ID, Name, Vorname, Geburtsdatum, Geschlecht, Alter zum Untersuchungszeitpunkt, Art der Vorbehandlung (Direkt OP oder nRCT), Untersuchungsdatum.
* **Pathologischer N-Status:** Ergebnis der histopathologischen Untersuchung ('+' für positiv, '-' für negativ).
* **Avocado-Sign-Status:** Ergebnis der AS-Bewertung im T1KM-MRT ('+' oder '-').
* **Lymphknoten-Anzahlen:** Gesamtzahl und Anzahl positiver Lymphknoten für Pathologie, AS und T2 (angewandt).
* **T2-Lymphknotenmerkmale:** Ein Array von Objekten, wobei jedes Objekt einen einzelnen Lymphknoten repräsentiert und dessen morphologische Eigenschaften im T2-MRT speichert (Größe, Form, Kontur, Homogenität, Signal).
* **Bemerkungen:** Freitextfeld für zusätzliche Informationen.

### 5.3 Pseudonymisierung
Alle Patientendaten in der Anwendung sind pseudonymisiert, um den Datenschutzbestimmungen zu entsprechen. Die Originaldaten und die Zuordnung zu realen Patientenkennungen sind nicht Teil dieser Anwendung.

## 6. Technische Aspekte

### 6.1 Technologie-Stack
* **Frontend:** HTML5, CSS3, JavaScript (ES6+)
* **UI-Framework & Bibliotheken:** Bootstrap 5.3, D3.js v7 (Datenvisualisierung), Tippy.js & Popper.js (Tooltips), PapaParse (CSV-Export), JSZip (ZIP-Generierung), Font Awesome (Icons), html2canvas (Tabellen-PNG-Export).
Die Anwendung ist eine reine Client-Side-Applikation und benötigt keine Backend-Komponente.

### 6.2 Web Worker für Brute-Force
Die rechenintensive Brute-Force-Optimierung der T2-Kriterien wird in einem separaten Web Worker Thread ausgeführt (`workers/brute_force_worker.js`). Dies verhindert ein Einfrieren der Benutzeroberfläche während der Optimierung und ermöglicht eine Fortschrittsanzeige.

## 7. Wichtige Hinweise und Limitationen

### 7.1 Forschungszweck
Diese Anwendung wurde primär als Werkzeug für wissenschaftliche Analysen und zur Unterstützung der Forschung im Bereich der Rektumkarzinom-Bildgebung entwickelt.

### 7.2 Keine klinische Diagnostik
Die Ergebnisse und Funktionen dieser Anwendung sind **ausdrücklich nicht für die klinische Diagnosestellung, Behandlungsplanung oder Patientenversorgung vorgesehen oder validiert**. Sie ersetzen in keiner Weise eine professionelle medizinische Beurteilung.

### 7.3 Statistische Validierung
Obwohl die implementierten statistischen Methoden gängigen Verfahren folgen, sollten Ergebnisse, die für finale wissenschaftliche Aussagen oder Publikationen von hoher Tragweite bestimmt sind, idealerweise mit etablierter Spezialsoftware für Statistik (z.B. R, SPSS, SAS) gegenvalidiert werden.

## 8. Autoren und Kontakt

* **Dr. med. Markus Lurz** (Konzept, medizinische Expertise, Datenakquise und -aufbereitung, Co-Entwicklung der Anwendung)
    * Klinik für Diagnostische und Interventionelle Radiologie, Klinikum St. Georg gGmbH, Leipzig
    * E-Mail: (Bitte offizielle Kontakt-E-Mail bei Bedarf einfügen)
* **Prof. Dr. med. A.O. Schäfer** (Wissenschaftliche Leitung, medizinische Expertise, Co-Autor der Primärstudie zum Avocado Sign)
    * (Affiliation bei Bedarf einfügen)

Für Anfragen bezüglich der Anwendung oder der zugrundeliegenden Studie kontaktieren Sie bitte Dr. med. Markus Lurz.
